{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Traffic Death Analysis\n",
    "\n",
    "In this exercise, we will be analyzing the effect of alcohol taxes on traffic death in the United States.  The data set used in this exercise, `fatalities.csv`, is a state-year panel dataset (meaning it includes data on multiple states, and the data includes several years of data for each state. The data contains 336 observations on 34 variables. The variables used in the exercise are defined as follows:\n",
    "\n",
    "`state`: factor variable indicating states\n",
    "\n",
    "`year`: factor variable indicating years\n",
    "\n",
    "`beertax`: numeric variable, Tax on the case of beer\n",
    "\n",
    "In these exercises, we'll be looking at how beer taxes (which are believed to reduce alcohol consumption, potentially reducing drunk driving deaths) impact car accident fatality rates. \n",
    "\n",
    "More specifically, though, we'll be approaching our estimation of the impact of beer taxes in a few different ways in an effort to give you more of an intuitive sense of what happens when you add fixed effects to a regression. \n",
    "\n",
    "## Exercise 1\n",
    "\n",
    "Download and load the data from [this link](https://media.githubusercontent.com/media/nickeubank/MIDS_Data/master/us_driving_fatalities.csv), or by going to [www.github.com/nickeubank/MIDS_Data/](www.github.com/nickeubank/MIDS_Data/) and downloading the `us_driving_fatalities.csv` dataset. \n",
    "\n",
    "How many states does this dataset contain? What's the time frame of this dataset? (From which year to which year). And what constitutes a single observation (i.e. what is the unit of analysis for each row of the data?)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from scipy import stats\n",
    "import statsmodels.api as sm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv(\"https://media.githubusercontent.com/media/nickeubank/MIDS_Data/master/us_driving_fatalities.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>state</th>\n",
       "      <th>year</th>\n",
       "      <th>spirits</th>\n",
       "      <th>unemp</th>\n",
       "      <th>income</th>\n",
       "      <th>emppop</th>\n",
       "      <th>beertax</th>\n",
       "      <th>baptist</th>\n",
       "      <th>mormon</th>\n",
       "      <th>...</th>\n",
       "      <th>nfatal2124</th>\n",
       "      <th>afatal</th>\n",
       "      <th>pop</th>\n",
       "      <th>pop1517</th>\n",
       "      <th>pop1820</th>\n",
       "      <th>pop2124</th>\n",
       "      <th>milestot</th>\n",
       "      <th>unempus</th>\n",
       "      <th>emppopus</th>\n",
       "      <th>gsp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>al</td>\n",
       "      <td>1982</td>\n",
       "      <td>1.37</td>\n",
       "      <td>14.4</td>\n",
       "      <td>10544.152344</td>\n",
       "      <td>50.692039</td>\n",
       "      <td>1.539379</td>\n",
       "      <td>30.355700</td>\n",
       "      <td>0.32829</td>\n",
       "      <td>...</td>\n",
       "      <td>32</td>\n",
       "      <td>309.437988</td>\n",
       "      <td>3942002.25</td>\n",
       "      <td>208999.593750</td>\n",
       "      <td>221553.43750</td>\n",
       "      <td>290000.06250</td>\n",
       "      <td>28516.0</td>\n",
       "      <td>9.7</td>\n",
       "      <td>57.799999</td>\n",
       "      <td>-0.022125</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>al</td>\n",
       "      <td>1983</td>\n",
       "      <td>1.36</td>\n",
       "      <td>13.7</td>\n",
       "      <td>10732.797852</td>\n",
       "      <td>52.147030</td>\n",
       "      <td>1.788991</td>\n",
       "      <td>30.333599</td>\n",
       "      <td>0.34341</td>\n",
       "      <td>...</td>\n",
       "      <td>35</td>\n",
       "      <td>341.834015</td>\n",
       "      <td>3960008.00</td>\n",
       "      <td>202000.078125</td>\n",
       "      <td>219125.46875</td>\n",
       "      <td>290000.15625</td>\n",
       "      <td>31032.0</td>\n",
       "      <td>9.6</td>\n",
       "      <td>57.900002</td>\n",
       "      <td>0.046558</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>al</td>\n",
       "      <td>1984</td>\n",
       "      <td>1.32</td>\n",
       "      <td>11.1</td>\n",
       "      <td>11108.791016</td>\n",
       "      <td>54.168087</td>\n",
       "      <td>1.714286</td>\n",
       "      <td>30.311501</td>\n",
       "      <td>0.35924</td>\n",
       "      <td>...</td>\n",
       "      <td>34</td>\n",
       "      <td>304.872009</td>\n",
       "      <td>3988991.75</td>\n",
       "      <td>196999.968750</td>\n",
       "      <td>216724.09375</td>\n",
       "      <td>288000.15625</td>\n",
       "      <td>32961.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>59.500004</td>\n",
       "      <td>0.062798</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>al</td>\n",
       "      <td>1985</td>\n",
       "      <td>1.28</td>\n",
       "      <td>8.9</td>\n",
       "      <td>11332.626953</td>\n",
       "      <td>55.271137</td>\n",
       "      <td>1.652542</td>\n",
       "      <td>30.289499</td>\n",
       "      <td>0.37579</td>\n",
       "      <td>...</td>\n",
       "      <td>45</td>\n",
       "      <td>276.742004</td>\n",
       "      <td>4021007.75</td>\n",
       "      <td>194999.734375</td>\n",
       "      <td>214349.03125</td>\n",
       "      <td>284000.31250</td>\n",
       "      <td>35091.0</td>\n",
       "      <td>7.2</td>\n",
       "      <td>60.100002</td>\n",
       "      <td>0.027490</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>al</td>\n",
       "      <td>1986</td>\n",
       "      <td>1.23</td>\n",
       "      <td>9.8</td>\n",
       "      <td>11661.506836</td>\n",
       "      <td>56.514496</td>\n",
       "      <td>1.609907</td>\n",
       "      <td>30.267401</td>\n",
       "      <td>0.39311</td>\n",
       "      <td>...</td>\n",
       "      <td>29</td>\n",
       "      <td>360.716003</td>\n",
       "      <td>4049993.75</td>\n",
       "      <td>203999.890625</td>\n",
       "      <td>212000.00000</td>\n",
       "      <td>263000.28125</td>\n",
       "      <td>36259.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>60.700001</td>\n",
       "      <td>0.032143</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0 state  year  spirits  unemp        income     emppop   beertax  \\\n",
       "0           1    al  1982     1.37   14.4  10544.152344  50.692039  1.539379   \n",
       "1           2    al  1983     1.36   13.7  10732.797852  52.147030  1.788991   \n",
       "2           3    al  1984     1.32   11.1  11108.791016  54.168087  1.714286   \n",
       "3           4    al  1985     1.28    8.9  11332.626953  55.271137  1.652542   \n",
       "4           5    al  1986     1.23    9.8  11661.506836  56.514496  1.609907   \n",
       "\n",
       "     baptist   mormon  ...  nfatal2124      afatal         pop        pop1517  \\\n",
       "0  30.355700  0.32829  ...          32  309.437988  3942002.25  208999.593750   \n",
       "1  30.333599  0.34341  ...          35  341.834015  3960008.00  202000.078125   \n",
       "2  30.311501  0.35924  ...          34  304.872009  3988991.75  196999.968750   \n",
       "3  30.289499  0.37579  ...          45  276.742004  4021007.75  194999.734375   \n",
       "4  30.267401  0.39311  ...          29  360.716003  4049993.75  203999.890625   \n",
       "\n",
       "        pop1820       pop2124 milestot  unempus   emppopus       gsp  \n",
       "0  221553.43750  290000.06250  28516.0      9.7  57.799999 -0.022125  \n",
       "1  219125.46875  290000.15625  31032.0      9.6  57.900002  0.046558  \n",
       "2  216724.09375  288000.15625  32961.0      7.5  59.500004  0.062798  \n",
       "3  214349.03125  284000.31250  35091.0      7.2  60.100002  0.027490  \n",
       "4  212000.00000  263000.28125  36259.0      7.0  60.700001  0.032143  \n",
       "\n",
       "[5 rows x 35 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "48"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.state.nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1982"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.year.min()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1988"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.year.max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Make sure all same min and max\n",
    "assert (df.groupby('state').year.min() == df.year.min()).all()\n",
    "assert (df.groupby('state').year.max() == df.year.max()).all()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# So 48 states, running from 1982 to 1988\n",
    "# One row is one state-year. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 2\n",
    "\n",
    "We use the fatality rate per 10,000 as the dependent variable. Construct this variable. Name it as `fat_rate`.  Hint: You can compute it using total fatalities(`fatal`) and population (`pop`). Note that because `pop` is often the name of a method in Python, you may have to navigate around some issues. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['fat_rate'] = (df.fatal / df['pop']) * 10000"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 3\n",
    "\n",
    "Draw a scatter plot using `beertax` as the x-axis, and `fat_rate` as the y-axis. Draw a fitted line showing the correlation between these two variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fc0e858a860>]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXQAAAD4CAYAAAD8Zh1EAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8li6FKAAAgAElEQVR4nO2dfZQU9Znvv8/09GAPggMyCDTMMIABRaSHzPrG3iyQvSoSkaAu6iIzcc/lqOs5q8mSg4m7QI7nygk3r2s2HPbGZTh6CYmQEaMJcha9ut6FODg9jAQxCPLSGN6GAWEapqfnuX/0C9019dpd3V1V83zO4TBd9euqX3VVfeup5/c8z4+YGYIgCIL7KSt1BwRBEAR7EEEXBEHwCCLogiAIHkEEXRAEwSOIoAuCIHiE8lLteMSIETx+/PhS7V4QBMGV7N69+zQzV6utK5mgjx8/Hq2traXavSAIgishosNa68TlIgiC4BFE0AVBEDyCCLogCIJHEEEXBEHwCCLogiAIHkEEXRAEwSOULGzRibS0RbBm234c74piTFUAy+6ajAX1wVJ3SxAEwRQi6Ela2iJ4dksHorE4ACDSFcWzWzoAQERdEARXIC6XJGu27U+LeYpoLI412/aXqEeCIAjWEEFPcrwramm5IAiC0xBBTzKmKmBpuSAIgtMQQU+y7K7JCPh9WcsCfh+W3TW5RD0SBEGwhgyKJkkNfEqUiyAIbkUEPYMF9UERcEEQXIu4XARBEDyCCLogCIJHEEEXBEHwCCLogiAIHsG0oBORj4jaiOi3KuuIiH5KRAeIaA8RzbC3m4IgCIIRViz0fwCwT2PdXADXJ/8tBfDzPPslCIIgWMSUoBPRWADzAPxvjSb3AdjACXYCqCKi0Tb1URAEQTCBWQv9xwC+DaBPY30QwNGMz8eSywRBEIQiYZhYRERfA3CSmXcT0SytZirLWGVbS5FwyaCmpsZCN/sjtcsFQRCyMWOhzwQwn4g+A/BLAHOI6GVFm2MAxmV8HgvguHJDzLyOmRuYuaG6ujrHLl+pXR7pioJxpXZ5S1sk520KgiC4HUNBZ+ZnmXksM48H8BCAHcy8WNFsK4AlyWiX2wCcY+bP7e9uAqldLgiC0J+ca7kQ0eMAwMxrAbwJ4B4ABwB0A/iGLb3TQGqXC4Ig9MeSoDPzOwDeSf69NmM5A/h7Ozumx5iqACIq4i21ywVBGMi4MlNUapcLgiD0x5Xlc6V2uSAIQn9cKeiA1C4XBEFQ4kqXiyAIgtAf11roTkAruUmSngRBKAUi6DmSSm5KxcOnkptaD3di8+5Iv+UARNQFQSgo4nLJEa3kpo27jkrSkyAIJUEEPUe0kpji3K+EjW57QRAEuxBBzxGtJCYfqdUpk6QnQRAKjwh6jmglNz186zhJehIEoSSIoOfIgvogXlg4DcGqAAhAsCqAFxZOw/MLpmUtH1bpx6DyMjyzKYyZq3dIRUhBEAoGsYbPt9A0NDRwa2trSfZdLJSRMEDCWn9h4TSJeBEEISeIaDczN6itEwu9gEiZX0EQiokIegGRMr+CIBQTEfQCohXZIhEvgiAUAhH0AiJlfgVBKCaS+l9ApMyvIAjFRAS9wEiZX0EQioW4XARBEDyCCLogCIJHMHS5ENFVAN4FMCjZ/lVmXqFoMwvAawAOJRdtYebv2dtV5yD1zgVBcCJmfOiXAcxh5gtE5Afwn0T0O2beqWj3HjN/zf4uOgutOuiAfr1zeQgIglBoDF0unOBC8qM/+a809QIcQC7Zn6mHQKQrCsaVh4DUdREEwU5M+dCJyEdEYQAnAWxn5l0qzW4nonYi+h0RTdXYzlIiaiWi1lOnTuXR7dKRS/anlAAQBKEYmBJ0Zo4zcwjAWAC3ENFNiiYfAqhl5ukA/gVAi8Z21jFzAzM3VFdX59PvkpFL9qeUABAEoRhYinJh5i4A7wC4W7H8fMotw8xvAvAT0Qi7Oukkcsn+lBIAgiAUA0NBJ6JqIqpK/h0A8NcAPla0GUWUmKqHiG5JbveM/d0tPVp10PUGOKUEgCAIxcBMlMtoAM1E5ENCqH/FzL8loscBgJnXAngAwBNE1AsgCuAhLlWh9SJgNftTSgAIglAMDAWdmfcAqFdZvjbj7xcBvGhv19yPhCoKglBMXFnLxQ1CmWu8uiAIQq64LvXfLTHdEqooCEKxcZ2gu0UoJVRREIRi4zpBj2gIotbyUiGhioIgFBvXCbovER1penmpkFBFQRCKjesGReMa0ZBay0uFl0IV3TAILQiCCwU9WBVQda8EHejK8MJsRRKtIwjuwXUul9lTqqF0rjjJldHSFsHM1TtQt/wNzFy9w3HRN1ZxyyC0IAgus9Bb2iLYvDuSVbuXANz/ZWdYwl60ZiVaRxDcg6ssdDVrkQG8/bFxKd5iWM5etGYlWkcQ3IOrBD1Xa7FYyUhetGYlWsc5eM2dJ9iPq1wuYzQGRI2sRT3LOR9XiDL6o6rSj7PdMcv9czJeitZxM1505wn24ypBX3bX5KyLGjBnLRbCcla7wfxlBL+PEItf8fJ7wZr1QrSO2ymUUSJ4C1cJeq7WYq6WvR5qN1isj1EV8GPwoHKxZgVb0TNKJE9ASOEqQQdysxZztez10LrBzkVjCK+4M+ftCoIaWkZJVaVfXDFCGlcNiuZKLrMMGSHRH0Ix0RqcZobnIquE3HGdhZ4rdvuB1ax+ALh4uRctbRGxjgRb0XI3PrMprNrezZFVQu64UtCd4DNM7W/V63uzIlu6ojF55RUKgppRsmbbftvHhwT34jqXi5MmuFhQH0RlRf9norzyCsVC8gSETFwn6E7LxvRiMpHgHgoxPiS4F0OXCxFdBeBdAIOS7V9l5hWKNgTgJwDuAdANoImZP7S/u84T0EKERAqCFSRPQEhhxkK/DGAOM08HEAJwNxHdpmgzF8D1yX9LAfzc1l5m4LToEnnlFQTBKRha6MzMAC4kP/qT/5SzSdwHYEOy7U4iqiKi0cz8ua29RaJ87ss7j6guLwWSGi/YhRMG+wV3YyrKhYh8AHYDmATgZ8y8S9EkCOBoxudjyWVZgk5ES5Gw4FFTU5NTh7UqK5qpuFgo5JVXyBep1SLYgalBUWaOM3MIwFgAtxDRTYomahN69psTjpnXMXMDMzdUV+dmUTvNhy7kh1QQTOC0wX7BnViKcmHmLgDvALhbseoYgHEZn8cCOJ5XzzRwmg9dyB0nhaCWGjFUBDswFHQiqiaiquTfAQB/DeBjRbOtAJZQgtsAnCuE/xyQQUgvIVbpFcRQEezAjA99NIDmpB+9DMCvmPm3RPQ4ADDzWgBvIhGyeACJsMVvFKi/JR+EfK6lAxt3HUWcGT4iPHzrODy/YFpR9u0GrAzsiVV6hUIUkBMGHmaiXPYAqFdZvjbjbwbw9/Z2TZtSDUI+19KRFWETZ05/FlG3PrAnMfxXKLWhIngDV9ZyKRUbdx3VXC6Cbn0SBrNW6UAJ55NoKSFfRNBNkBKUOPcL3AEAzeUDDasuFDNWqYTz5cZAeQgK2QxYQTd7wSsFRQ0fqUVtDjxycaEYWaUy9Zp15CHoPP70pz9hw4YN+Oijj/Czn/0MY8aMKch+XFecyw6shMupCYqSh28dl97uQI6pLkQEkgycWkeih0pHPB7HW2+9hUceeQRElP73pS99Cc8//zxaWlrwX//1XwXb/4C00K1YfXrCkRnlIlZRYQb2ZODUOmYeguKSyZ/Ozk788pe/RHNzM/7whz/otq2urkZjYyOWLFmCadMKN942IAVd64KPJCfczbywtQQlWBXA+8vnpK1ytTYDwTWgJgzvL59j2/ZmT6nG5t0RCeezgNFDUIwP63R0dKC5uRnr16/HmTNndNveeuutaGpqwqJFizBs2LAi9TDBgHS56Fl3SteLnhsh03WjRaQr6lk3jN2Znmrb27w7gvu/HJR63xYwcn2JS0abnp4etLS04Otf/3qWy+Tmm2/GD37wg35i/sgjj2Dbtm3o7e0FM4OZsXPnTjz++ONFF3NggFroWvOBAv2taj03wszVOwz96wSkBd9rlpDdA5Za23v741N5Wf0DDSPXl4xLJDhx4gReeeUVrF+/Hh0dHbptx40bh6amJixZsgSTJk0qUg+tMyAFfUF9EK2HO1XL8ALoZ3FnRmKkXALPbAr3rz6mgNC/QpmX3DB2C4MXhaZUvmq96KGBNi7BzPjggw+wfv16NDc3o7u7W7f97Nmz0djYiIULF2LIkCFF6qU9DEhBb2mLYPNubbcAJdsob4iWtgiWvdqOWNw47jyocdMA7haoTOwWBq8JjVN91V4uMxCNRvHaa69h/fr12LZtm27b8vJyNDY2oqmpCTNnzgR5IPx4QAq6USgiJ9sob7pVr+81FHMC8KNFobRLJheBcksEgt3C4DWh0XIhrXp9b0nPr1fKDBw5cgQbNmxAc3MzDhw4oNt28uTJaGxsxOLFizFu3Djdtm5mQAq6GQtZrc3Z7pjh9xjAM5vCWLNtf04RGk616tSwWxi8IjQptK6zs92x9LVUqvPrpjIDfX19eO+999JRJmyQmT137lw0NTVh/vz5uOqqq4rUS2cwIAVd69Ve2SZXlBEab398yrRAuS0z0m5hcJPQGGHmOgOcfX6LzRdffIFf//rXaG5uxrvvvqvbdsiQIWhqakJjYyNmzJjhCZdJvrhS0PN1SehFuQDaVnRVwI+uqLGVniIai2PjrqP4wd9MN90/Lw4MDlSMrrNMBuL5/dOf/pS2uiMR/VDXUCiExsZGPPLIIxg5cmSReug+XCfodrgkUlEuqbrmZQQMKi/DpVif7gNi5fypWPbrdsT6zBfjijNb6p/XBgb1sHuswGljD2oupIuXe1WNAi+e3xTxeBzbt2/H+vXrsWnTJsP2999/PxobG3H33XfD7/cXoYfewXWCbodLIhXlkqqSmNBnSg9mptpoicO3ftVuqcKilf55bWBQC7vHCpw69qB0IakVe3Pq+c3lAdnZ2YmNGzeiubkZH3zwgW5b3+AqDJ46B4Nv+ioqqmsR8PskaSxPXJcpaodLwihTTi1j8elNYYRWvQUA6MuhXK7Z/i2oD+KFhdM8nxlpd7aiW7If3XJ+zWQB79mzB9/85jdx7bXXpjMqr732Wjz11FP9xPz222/H2rVr0dnZCWbGHS/8B8Y+9TKGzX4MFdW1ALTP10AvemcF11nodrgkjB4KWmGNXdEYnt4U1t22WjKR2f4pLaLMN4ZiU2j3xUBOSnLDwG/mPcDxGKKffoCTH+3A15/fafjdxYsXo7GxEbNnz4bP51NtY/Z8OfXNy6m4TtDtcEkYPRTyEYHKCh/6GJb7p3bhLnu1HSu37sW5aKyoPuFi3ERa54CRmOrPaAYo5QOnqtKvGlbqZd90Ifjzn/+Ml19+GR/84EXETh/WbVtbW4umpiY8+uijmDhxoqX9mDXM3Bb1VWpc53Kx45XVqHhRPiJwsSeeUzEptQs3Fmd0RWO2FL6yQjHcF2rnIMXLO4/guRbt2hpq7oALl3rh92WHrTnVN+0EmBm7du3Ck08+icrKyrTLZPTo0Vi2bFk/Mb+q9mZcO+8Z3Lryt+kiVJ999hlWrlxpWcwB87Xz3fTm5QQMLXQiGgdgA4BRAPoArGPmnyjazALwGoBDyUVbmPl79nb1Cvm+smZGH0S6ovARZQmWlXAzNXIpJmXmAjVrmeTrLin0TZTqn97vqzVPa0tbRHVQOtbHqAr4MXhQuWOiXJxCd3c3WlpasH79emzfvl23bUVFBRobG1F3+z1o/nQQLvX2pdcF/D4sn29PLW+zSWRmLHmnRTeVEjMul14A32LmD4loCIDdRLSdmf+oaPceM3/N/i4WhtQJV3MtvLBwGl5YOA2rXt9rKjtUSapkrpULzGwSipGo2uEu0XOHzFy9I68bxsyUfkD2PK2pGzbSFdUcowCAc9EYwivuzKlf+eAkQTl8+HA6Hf7TTz/VbTtlyhQ0NTVh8eLFCAb79/eGAh+XGcPMyMUqPvZsDAWdmT8H8Hny7y+IaB+AIACloLsOPdfC+8vnYEF9EM+1dOCVnUcMKytmkkvJXLNvBUbuIDt8jnp9yfeGMTOlH3BlnlblDat3Hq4JFD9muVSC0tfXh3fffTddQdCIefPmobGxEffee6/pdHgnDN4aWfLiY8/G0qAoEY0HUA9gl8rq24moHcBxAP/IzHtVvr8UwFIAqKmpsdpXW8i0prTEIdMKfn7BNDTUDk9/p7LCh+6eOBhAWdJc7FN8P5eSucoLt6rSjwuXerOSmMz4hO1wlyhdUkryuWHM9iM1T6vZBwAAXOzpVa2SWUiKISjnz59Pp8O/9957um2HDh2KpqYmNDU1IRQKeSIdXu/BIj72bEwLOhFdDWAzgKeZ+bxi9YcAapn5AhHdA6AFwPXKbTDzOgDrAKChocF6MHeemH3dV1rBqQsq9f1Ux/sY8PsIQyvK0RWN6boD1Ka3U6KWhGL1ldeuTNNUX+qWv6F6TLneMEaupcx5Wq3uJxbnoltmdgvK/v370dzcjObmZhw/fly37YwZM9DY2IiHH34Y1dXVOe3P7QykzGozmBJ0IvIjIeavMPMW5fpMgWfmN4noX4loBDOftq+r1lEKYndPr6GY61nBWpEoRAkhMsoeXfZqOwBrJQqsipPdmaZ23zBa/cuMBEolkhzviqLMxO+aSbEts1x/n97eXmzfvh3Nzc2m0uEfeOABNDU14c4775R0+Azsut6dNA6SD2aiXAjALwDsY+YfarQZBeAEMzMR3YJEOKT+TKoFRs23aQQBuP/L1l/vzA6cxuKMVa/vLfiFMqi8LH3cwyr9WHHv1Jz3aeWGMXNTGPlElefNipgDxbfMzPw+Z86cwcaNG7F+/Xrs3r1bd3ujRo1CY2MjGhsbccMNNxSs317BjpLLXhpYNWOhzwTwKIAOIkqlSX4HQA0AMPNaAA8AeIKIegFEATzERkWLC4wV32sKRiLkUAuzkSh65BI1Y4ReFMilmNLDbw2zN4yVm0LvzcPKeVMeaynizpW/zwhfFHOvu4R/e24pvv7mm7rfveOOO9DU1IQHH3wQVVVVxeiuJ8l38NZLA6tmolz+E4l7R6/NiwBetKtTdmB3CjmQf3x6ITCKArHjwjRzw+RzU5gZqFaDkUjc0nrQFPI1Oh6P45NPPkE4HEY4HMaQ9nZEw2G0njiBVpX2S5YsQWNjI2bNmoWyMtfl83kaLw2sui713yxa1nQq+UTL0tZ7ZbdSDlWLKptD68xYtMW4MHO9KcwOVKsRrApoJnBpvTG0Hu60NOEIkJh0Yc+ePWhvb08LeEdHBy5dugQA8Pv9mDp1KubOnYvp06cjFAph+vTpGDZsmOVjyhWv+IBLgZcGVj0r6Fq+zZXzp2ZFrFgdTDFbDvX+Lwex6Q9Hs8IO/WWElfOn2nF4acyIdTEuzFxvCjMPJH8ZAYSs+VyNzpXWG0NmToHSLcTMiEQiadEOh8Nob2/Pmq9y+PDhmD59Op544gmEQiGEQiFMmTIFFRUVuseQD0Zi7SUfcCnwUslqzwq6ke/XymBKpo86Fc0SVElwUG4nM349V6vJ6GY28usX68LM9abQeyARkD5mwNrAl9Z2U2LO8V7EzhzFhZOH8OQ7v8C/VHQiHA6js7Mz3XbixInpmXJSlvfYsWOLGtttRqy95AMuBXYMrDoFKtXYZUNDA7e2qnkbi4PZV1Q9l4BeQX697eezb7UQP2Wb1GCh8qFTaHJ57Z+5eofqA0nPnWKGzO32XbqAnpOH0HPyIHpOHELs1CH0nD4MxHsBAFRegYb66WnRDoVCmDZtGoYOHZrz/u3CzO+jlStAAA6tnlfYDgpFh4h2M3OD2jrPWuh6KNP59V5R9VwCWlaQnlUFqNePMbtv5T6dZF2UOm4+VQEwHA5j3KH3sOednYj++VPEz59MtymrrELFyDoMbbgPFSPr4B85AePrJuH/ffe/W95fMTAzNuElH7DdDLSxBc8LuvKEjr82gPc/7ezXLhqLq8aIG/moU4W4zNaXSP2tts7svpU3rxNqbqSwegPl+kC6dOkS/vjHP2b5utvb23Hu3DkAABFhTO1EDBp/I+LD5mJ03RTc+ZVbse3g5X4Pj2/fc6MNR14YzIh1KX3AThbMQo8tOPHYPS3oaidUz998tjvWLz3fTOy58kIxK8SZqH1Hb9+hVW+lB3idQq43kNED6fTp02nRTgn4vn37EI8n9jN48GDcfPPNeOSRR9IRJjfddBMGDx6s2ken3YR6mBHrUr2lOX0wtpBjC049dk8Lei7JRSu3Zlvpy+6ajGWvtmdFWKiReaHkkoCk9nq87K7JeGZTWNU/2hWNOeICyiTfG6ivrw8HDhzIEu729nZEIlcm9QgGgwiFQpg/f37a3z1x4kTTsd1Oepsxg1mxLsVxOX0wtpDx5U49dk8Lei4nriva30o3m+2S2p/VBCRKfkfJgvqg7hymTriAMrFyA3V3d6OjoyPL8t6zZw8uXrwIAPD5fLjhhhswe/bstNU9ffr0AVmEyqkPIacn5BRybMGpx+5pQc81VT9TJNds258VS260P+CKVWV2ggyGtpUdNDiGUl9AmWj93iN8Ufz+97/Psro/+eQT9PUlyhIMHToUoVAIjz32WNrqvvHGG03X7fYCbnMFAc4fjC3k2IJTj93Tgp5rqn6mSJoVTDW/5sqt/UrCqxLUuQiMjqHUF1Am3/zqRCz7xe/xxfEDiTDBEwcRO3UIhy92YW6yTW1tLUKhEBYtWpQOExw/fryj63YXWmyd6o81wukJOYUcW8jl2Ivx0Pa0oC+oD6L1cCc27jpqqWpfVeWV9HyzVr4yHr2lLWKqJIDRRZDa5ne27EG3SqGtsxcvo275G6iq9IM5MQ1brhXnrFxsqXT4zKzKjz76KJ0Oj7JyDB41HnfMuRPzv3oHQqEQbr755qKmw9tBMcTWqf5YI5wUMqtFodxVVo+9WA9tTwt6S1sEm3dHLJdgTTVvaYugu6fXsH2wKqAaQ26EUbneFAvqg1izbT+61XzRSZHPdO0oL5Z8UsfvC43BsWPHstwl4XA4a77K4cOHIxQK4cknn0z7uwudDl8siiG2TvXHmsGp/v1iYOXYi/XQ9rSg5xLlAiSsXLNFo7QsbDM3o1G5XqvbyyQz7l0p1stebcfKrXvT1vzFy4mJPzgeQ+zMUfScPITOEwfR+H8Oo7zrSFY6/KRJkxAKhdJTnIVCIXxwEvhfb32CLV1R7IwEsOyma3GzB8QcyE1srb7tONUfK9hHsR7anhb0fKZJ03oYpKo1Gt2sZl01ZvuYywBvpCuqGiUTizPOnD2L2MmD2PfBoXRafOz0EaDvSjq8v7oWFeP+AnV/ORn/Y8FsPPXAVzFkyJCsbbW0RfCd37jP/2sWq2Kby6u1033RQv4U66HtaUHPNcolFf+txrloDOEVd5raRi7zl+a7PSXMjN5zJxBL1jHpOXkQPScPIn7+yptBWWUVKq6bgEBdPSpGTkDFyAkoHz4GVOYDkJgEe8NBH244cB4L6rMF3a3+X7NYFdtcfg83+KKF/CjWQ9vTgp6LCA4qL0v7rPN5ombepHoPFbXSAUbbO94VRVWlHxcu9WaFVHJvD3pOH0lHl/ScOIiek4fAPd2JBlSG8mFjMCh4Ayrq56FiZB0qRk6A72rjgUqr5Qnc4P81g1WxzfX3GMi+6IFAsR7anhb01I/1rV+1mx4Yvdzbh5a2iOrDgADMnmI+sSV1k4ZWvaUb8ZKLm8LfcwG3DDqD93ftxunD+xE/fQiXTh0FODFISv6rUDGyDoOnzkpa3XXwV9eizK8d210V8ONcNKaZR2WlPIGX/L9WxHYg/B5CbhTjoe1pQQeuCKQVS33Ntv14f/kctB7uzKrKyAA2746goXa4qROTGhwzE76oZQGn0uH/7Tc78O9b30H3nz9Fz8mD+OxCJz5ItgkGgxj1pSk4MfUvcXnoOFx13QRQ1SgQWZvqbPCgcoRX3KlZslWrPIFX/L92xAl76fcQ3IfnBR24Eo+eKc56pCzRtz8+lfMcnS1tESz7dbvpLFMAOHbyLHbu3NlvqrNUOjyoDP4RNbiqdnq69GvguglYPPsmbN4dgS8WR6XpvfVHr3SBlih5xf9rV5ywV34PwZ0YCjoRjQOwAcAoJMbH1jHzTxRtCMBPANwDoBtAEzN/aH93c0dNnLVIWaL5+IdXbt2rKebMjPjFs4idOJgcpExEmvSejeD2HyW+k0qH/7u/+zuEQiF89/+eh39EDai8fzig2QeVEcrSBWZFyQv+XzsHd73wewjuxIyF3gvgW8z8IRENAbCbiLYz8x8z2swFcH3y360Afp78v2gYvS5bGaS7eLkXdcvfQFlyujklRv7QzCxR7osjduZY1iBl76mD6L14Lt3ed811CIyagHkPPIiH5n4FoVAItbW1IKL0cVWM0u6/HWKuVrpgIImS1wd3hYGBoaAz8+cAPk/+/QUR7QMQBJAp6PcB2MCJ+ex2ElEVEY1OfrfgmHldNhvCWEZIi7GamOv5Q8+fP48XX/0P/PRX23Hx808Tlvepz4B40ofuK0fFiFp85at3o7x6PDqiw1FeXQt/YAgevnUcnl8wTfe4rFIV8ONyb5/h94s9VZ0TkcFMwQtY8qET0XgA9QB2KVYFARzN+HwsuSxL0IloKYClAFBTU2OtpzpovS5nzkBkNoRRzUviI0Ifc9ryvy80BkeOHMnydYfDYRw8eDD9nbLAUFSMrMOQGfMSUSbXTYB/+FiQrxyf+8vAIFQk+xJnVh1szTXTFQD8ZYSV86emt2MUOvn0pjBWvb4XK+5VnzSjpS2ClVv3ph92wyr9mm3diAxmCl7AtKAT0dUANgN4mpnPK1erfKWfNDLzOgDrgMQk0Rb6qYuWWGXOQKSMC09NpGwEx2O4dOYo/udfDUU4HMY/Lf0nPLi3A73RL9JtJk2ahBkzZuCxxx7DT8IxVFTXwTfkWs0KgmpFttT8tWZf9/1lhD4A8cynUXLXqWOf+OybhqGbZ7tjWPZqe/p7KdQGeLXauhUZzBS8gClBJyI/EmL+CjNvUWlyDMC4jM9jARzPv3vm8Gn4uoHs2uYpcWtpi+C7v+nAxZ5s6zce/QKxk6i5sMgAABBXSURBVFdS4RPp8EeBvl40/TtQMWgQyq4dj6u+NDMdZTJ0zAR8/+Fb09sd/IX6DENmUAq4lhtAWX6gu6e3X931WJzTtVzWbNtvOg4/9T3lm4LaAK9aWzcz0MYNBO9hJsqFAPwCwD5m/qFGs60AniKiXyIxGHquWP5zQN3XnUIpki1tEfzjr9sQ7TyhiDLJTof3DR4G/8g6BOq+jMCoCfjuo3Ox8eMYjn/Rk7W9HiQSl57ZFEYZUV4DlEp/rZobwF9GIEq8lfiIDF0p+daDV/tsdp0gCMXFjIU+E8CjADqIKFXg5DsAagCAmdcCeBOJkMUDSIQtfsP+rqrT0hbRdZ+MGuxDa2tr2t/d/Nt3cOH4p+CepBBRGfzDgxgUvBEV9XWa6fAv7e1Bl8bsQ6kHipUyvco+q/lrlW6AawJ+XMywxo325yPKyQd/TcCPmat3pN8Argn4NZOjZNBQEJwDscVa4XbR0NDAra2teW8nM6sxfrEr211y8hB6OyPgvoSoXX311YhdMw7+ZCp8xXUT4B9Ro5sObwdK8U59TrmKzEaZaGVwqhHw+3TFfFilH+e6Y1B688sI8JVR1qTYfh8hHud+bf0+wpoHpoubQhCKCBHtZuYGtXWuzBSNx+M4cOAAwuEw9r62GZeT4h2/cKVut2/ICFSMrMPQKTPx2Py/wtKvfxUTJkzAf/v+O7qiqOePz4WA34cZNddg58Gz6e2mth5nTlvmZkTRjHuDgPSAnlZ0i48IK+5NRMAoI1cAqPrjywgIlJchmhzQ9VqUiyB4AVcK+saNG/Hoo48CAKjMh/JrxyXT4SfAf13C+vYFhqbbvx8P4PuTJgFIFNd6eeeRftssA/DDRSEAUK0hboXMMMfZU6p1Z02KxuL41q/MRYsYxdL7iPCDv8m2mNV86HFmPL0pjGGVfqycny3KdcvfUN12YkyU8ONFoaxZkJ7ZFJaIEEFwCK4U9FmzZuGll15CKBTCgZ5r8O3f7NMdjDzeFU0LkJYgXlPpTwtSptVqlYDflzW/6MzVOwz92HFmU3VDjGLpldsxqjZ5tjtmKQFLbxYkL01qIQhuxfU+dAB4rqVD1epOYTZj8rPV8wDknqGp5oaoW/6G6ciXYFUA7y+fo9vG6MEEJI4XgOmHUuZ+jY495dJR27+Z/guCkB96PnRr9VUdyvMLpqVFTAkBIIIpcW5piwBIWJkvLJyW9imb5Wx3DK2HO7OWWYkCMeMjX1AfxLK7JiOos92uaMzSG0bmflPH7tNIihpTFZC6J4LgUDwh6EBiajg1GNAMN1Sy6vW9WZ8vqWR0GvHyziPpBwOQcJME/D5T3zUj/ikLOpep9bQoI8JzLR2YuXoH6pa/gTXb9uPhW8f163dqAFernxLCKAilxZU+dDX03ACAdnmATM52xzB++RsIVgVw8XJvznVUlNmpqWV6ffD7yFTdkHzqu2gRZ85yWUW6oti8O4L7vxzE2x+fUk2Fl7onguA8PCPoRsWVrEw2ka/1m+l6MOPzBoDBFeW2hS7aQTQWx9sfn1L1iUvdE0FwJp4RdD2RaWmLqJcPKxBjqgJoaYtg1et7+8V0a2HW520UuugvA3LwFKmi9/CQuieC4Dw8I+iAtsis2bY/K/OxkPjLCLOnVOcUJRNa9Va/uHAlRqGLRmIe8Ptwlb/M1INGfOKC4C48MyiqR64ulEHlZZqGfcDvw+LbarIiYaoCfqx5cDre/vhUTn7urmgiLjxzUFVJKgolF4JVAbywcBpW3DvVcKBWfOKC4D48EYeuhVaZ3HxRy8jMnAIv31/UTDy3lbouQP+EJ+WUfbOnVGsOgAqC4Bz04tA9K+gtbREse7W9YK6WYDIe+5qAH7F4n60PDQJwKJnkpEUuyU+S+CMI7sfziUVqFNJvTki4cRgJN4lZMTc7LnuNRpJUJinXS7AqAEJCrAN+/dMZ6YqibvkbmLl6h65bRxAEd+KpQdFM7Arv0yp9a+X7KRcGoF4sq993TCq/chBYbao4JYyEsD+zKYynN4VlgmhB8BCeFXSj8D6z3DFxOD47E037lq1uU811YuRrN5vZqiQlymbCJVP7lsJaguAdPOtyWXbXZPh9+Qeff3jkHJbdNRmHVs/D+8vn6NZQUaJWC2ZBfRDvL5+DQ6vnaW4rn3DBBfVBtP3znfjxolDaHWNEZhVFQRDci2cFfUF9EIv+YpxxQwOUYmelNsu8m0frrlfbll3hgmYeHJlIYS1BcD+eFXQAePvjU8aNTJA5mAgALyycZjgACSQKdT3X0qG5Xm1gMxVjniqUZWYAs6UtotvezENIkogEwf141ocO2Gt1pgYTn93SgRcWTsPwwYNM+dNf3nkEDbXDNf3TagObViaPMNNeWSDMzATVgiC4D8M4dCJ6CcDXAJxk5ptU1s8C8BqAQ8lFW5j5e0Y7LkZikdXkG7OkYtDNRrtkTklnFFGi1WetGHKr7YH+SUUS5SII7iHfSaLXA3gRwAadNu8x89dy6FtBWXbXZDyzKZx35qYSqxEvqenfzESUWJ08IpfJJqSwliB4E0NHMDO/C6DTqJ0TWVAfxN/eVmP7dlNWbS4xNEYRJVYnj7BrsgkjP7wgCM7HrkHR24monYh+R0RTtRoR0VIiaiWi1lOn7BmwNOL5BdOw2GZRv3i5F4C1BKNMtKznlrYIunt6+y3X83HbESmTOQtS5liBiLoguAs7BP1DALXMPB3AvwBo0WrIzOuYuYGZG6qrq23Y9RX0LMyG2uG2lkPvisbw9KZwzt9Xs55ToqpMCKoK+LOKainRipSx4lJRmwVJYtMFwX3kHeXCzOcz/n6TiP6ViEYw8+l8t20WvUgPIJFuX5oSZP3Rsp61ppYbPMh4JqN8feIy6bMgeIO8BZ2IRgE4wcxMRLcgYfWfybtnFjCyMO2egzNXqgJ+zQksSimqWgO8EpsuCO7CUNCJaCOAWQBGENExACsA+AGAmdcCeADAE0TUCyAK4CEuck1ep1uYwyr9WHGv/kxEpRRVo/lYBUFwB4aCzswPG6x/EYmwxpLwXIu2OyUlhoWIRddiUHkZAn4fzkVjlmK8SymqMumzIHgDV2eKPtfSgZd3HlFdlymGhYhF12LE1YNymkSi1KIqsemC4H5cLegbdx3VXJcZ6aEXkRLwlyGqM7PysEq/qQmVU+Tj5hFRFQQhH1xdnCtu4KpPhTGW6cQsRmN9musX31ZjuTZ5GZEk5wiCUBJcbaHrkemPNhqiTU35lrLEiRLfefvjU6iyaKFbSfMXBEGwE1db6HpYCVXs6o6lJ4Xw+yj9AIh0RXEuGst5ogxJzhEEoZi4WtCtzB6kRyoaZtXre/tNLN3HgL+M0vtSc8/o1Rp3SuikIAjex9WCbkdIXyoapqUtoula6Y71pWumKOdfTqXmF2I6OUEQBCu4WtDz9U1nzhCUWSpADaPU/EJOJycIgmAGzw6KGpE5AcTM1Tt0fe5VAb9hNmqp48gFQRBcL+jK6dTMoLSc9fzc/jLCyvlT09O3Kcl0qUgcuSAIpcTVLhfAupirlaPV8nMTAWsenC4uFUEQXIHrBd1qpMvXpo/uZ0Uvu2uyamgiM/CdLXsQWvUWntkUxqDyMgyr9Odcd1wQBKGQuF7Q1SxnPV7eeaRfBueC+iAGV6h7n7pjfeiKxsBITGxxKdaHHy0K4f3lc0TMBUFwFK4XdLUZewaV6x/Wqtf39lt2LmouG1SShQRBcCquHxQF+g9Ghla9hcu92gW3znbHEFr1VtZkE1r1yNWQZCFBEJyI6y10NcxY213RWNZEyFZcN5IsJAiCE/GkoJsV3Ez3Scp1M6zSr/sdgj0ZqoIgCHbjSUG3Ym1nuk8W1AfTRbrUhJ0A/O1tNTIYKgiCI/GED11JZtamkV9czZpP+eRb2iKS+SkIgmugIs/nnKahoYFbW1uLsq/QqrfQpeJXJwA/WhQSkRYEwTUQ0W5mblBbZ+hyIaKXiOgkEX2ksZ6I6KdEdICI9hDRjHw7bDdag6QMmXxCEATvYMaHvh7A3Trr5wK4PvlvKYCf598te9EaJLWrnrogCIITMBR0Zn4XQKdOk/sAbOAEOwFUEdFouzpoB1KHRRCEgYAdg6JBAEczPh9LLvtc2ZCIliJhxaOmpsaGXZtDStsKgjAQsEPQ1SbcVB1pZeZ1ANYBiUFRG/ZtGiltKwiC17EjDv0YgHEZn8cCOG7DdgVBEAQL2CHoWwEsSUa73AbgHDP3c7cIgiAIhcXQ5UJEGwHMAjCCiI4BWAHADwDMvBbAmwDuAXAAQDeAbxSqs4IgCII2hoLOzA8brGcAf29bjwRBEISc8GQtF0EQhIGIJ2u5qCF1WQRB8DoDQtBb2iJ4dksHorE4ACDSFcWzWzoASOq/IAjeYUC4XNZs258W8xQylZwgCF5jQAi61pRxMpWcIAheYkAIulZxLplKThAELzEgBF2KcwmCMBAYEIOiUpxLEISBwIAQdECKcwmC4H0GhMtFEARhICCCLgiC4BFE0AVBEDyCCLogCIJHEEEXBEHwCCLogiAIHoES5cxLsGOiUwAOW/jKCACnC9QdJyDH5368foxePz7AHcdYy8zVaitKJuhWIaJWZm4odT8KhRyf+/H6MXr9+AD3H6O4XARBEDyCCLogCIJHcJOgryt1BwqMHJ/78foxev34AJcfo2t86IIgCII+brLQBUEQBB1E0AVBEDyCowSdiO4mov1EdICIlqusJyL6aXL9HiKaUYp+5oOJY5xFROeIKJz898+l6GeuENFLRHSSiD7SWO/qc2ji+Nx+/sYR0dtEtI+I9hLRP6i0cfs5NHOM7jyPzOyIfwB8AD4FMAFABYB2ADcq2twD4HcACMBtAHaVut8FOMZZAH5b6r7mcYxfATADwEca691+Do2Oz+3nbzSAGcm/hwD4xIP3oZljdOV5dJKFfguAA8x8kJl7APwSwH2KNvcB2MAJdgKoIqLRxe5oHpg5RlfDzO8C6NRp4upzaOL4XA0zf87MHyb//gLAPgDKmWHcfg7NHKMrcZKgBwEczfh8DP1/ZDNtnIzZ/t9ORO1E9DsimlqcrhUNt59DM3ji/BHReAD1AHYpVnnmHOocI+DC8+ikKehIZZkyptJMGydjpv8fIlGr4QIR3QOgBcD1Be9Z8XD7OTTCE+ePiK4GsBnA08x8Xrla5SuuO4cGx+jK8+gkC/0YgHEZn8cCOJ5DGydj2H9mPs/MF5J/vwnAT0QjitfFguP2c6iLF84fEfmRELpXmHmLShPXn0OjY3TreXSSoH8A4HoiqiOiCgAPAdiqaLMVwJLkKPttAM4x8+fF7mgeGB4jEY0iIkr+fQsS5+hM0XtaONx+DnVx+/lL9v0XAPYx8w81mrn6HJo5RreeR8e4XJi5l4ieArANiWiQl5h5LxE9nly/FsCbSIywHwDQDeAbpepvLpg8xgcAPEFEvQCiAB7i5LC7GyCijUhECIwgomMAVgDwA944hyaOz9XnD8BMAI8C6CCicHLZdwDUAN44hzB3jK48j5L6LwiC4BGc5HIRBEEQ8kAEXRAEwSOIoAuCIHgEEXRBEASPIIIuCILgEUTQBUEQPIIIuiAIgkf4/90JvfT6NBgFAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# fit a model\n",
    "from numpy.polynomial.polynomial import polyfit\n",
    "\n",
    "b, m = polyfit(df['beertax'], df['fat_rate'], 1)\n",
    "\n",
    "# scatterplot with fitted line\n",
    "plt.scatter('beertax', 'fat_rate',  data= df)\n",
    "plt.plot(df['beertax'], b + m * df['beertax'], '-', c = \"black\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 4\n",
    "\n",
    "Fit a simple OLS regression. This is what is called a \"pooled\" regression because we're \"pooling\" observations from different years into a single regression. What do your results imply about the relationship between Beer Taxes and fatalities?\n",
    "\n",
    "\\begin{align*}\n",
    "FatalityRate_i = \\beta_0 + \\beta_1 \\times BeerTax_i \\quad (1982 or 1988 \\text{ data}), \\\\\n",
    "\\end{align*}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>        <td>fat_rate</td>     <th>  R-squared:         </th> <td>   0.093</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.091</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   34.39</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Tue, 18 Feb 2020</td> <th>  Prob (F-statistic):</th> <td>1.08e-08</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>20:13:24</td>     <th>  Log-Likelihood:    </th> <td> -271.04</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>   336</td>      <th>  AIC:               </th> <td>   546.1</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>   334</td>      <th>  BIC:               </th> <td>   553.7</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Intercept</th> <td>    1.8533</td> <td>    0.044</td> <td>   42.539</td> <td> 0.000</td> <td>    1.768</td> <td>    1.939</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>beertax</th>   <td>    0.3646</td> <td>    0.062</td> <td>    5.865</td> <td> 0.000</td> <td>    0.242</td> <td>    0.487</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>66.653</td> <th>  Durbin-Watson:     </th> <td>   0.465</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 112.734</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>          <td> 1.134</td> <th>  Prob(JB):          </th> <td>3.31e-25</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>      <td> 4.707</td> <th>  Cond. No.          </th> <td>    2.76</td>\n",
       "</tr>\n",
       "</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:               fat_rate   R-squared:                       0.093\n",
       "Model:                            OLS   Adj. R-squared:                  0.091\n",
       "Method:                 Least Squares   F-statistic:                     34.39\n",
       "Date:                Tue, 18 Feb 2020   Prob (F-statistic):           1.08e-08\n",
       "Time:                        20:13:24   Log-Likelihood:                -271.04\n",
       "No. Observations:                 336   AIC:                             546.1\n",
       "Df Residuals:                     334   BIC:                             553.7\n",
       "Df Model:                           1                                         \n",
       "Covariance Type:            nonrobust                                         \n",
       "==============================================================================\n",
       "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "Intercept      1.8533      0.044     42.539      0.000       1.768       1.939\n",
       "beertax        0.3646      0.062      5.865      0.000       0.242       0.487\n",
       "==============================================================================\n",
       "Omnibus:                       66.653   Durbin-Watson:                   0.465\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):              112.734\n",
       "Skew:                           1.134   Prob(JB):                     3.31e-25\n",
       "Kurtosis:                       4.707   Cond. No.                         2.76\n",
       "==============================================================================\n",
       "\n",
       "Warnings:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "\"\"\""
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import statsmodels.formula.api as smf\n",
    "smf.ols('fat_rate ~ beertax', df).fit().summary()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 5\n",
    "\n",
    "Now estimate your model again, this time adding state fixed effects (using the `C()` notation and your normal linear model machinery). What does this result imply about the relationship between beer taxes and fatalities?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>        <td>fat_rate</td>     <th>  R-squared:         </th> <td>   0.905</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.889</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   56.97</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Tue, 18 Feb 2020</td> <th>  Prob (F-statistic):</th> <td>1.96e-120</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>20:13:24</td>     <th>  Log-Likelihood:    </th> <td>  107.97</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>   336</td>      <th>  AIC:               </th> <td>  -117.9</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>   287</td>      <th>  BIC:               </th> <td>   69.09</td> \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>    48</td>      <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "         <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Intercept</th>      <td>    3.4776</td> <td>    0.313</td> <td>   11.098</td> <td> 0.000</td> <td>    2.861</td> <td>    4.094</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ar]</th> <td>   -0.6550</td> <td>    0.219</td> <td>   -2.990</td> <td> 0.003</td> <td>   -1.086</td> <td>   -0.224</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.az]</th> <td>   -0.5677</td> <td>    0.267</td> <td>   -2.129</td> <td> 0.034</td> <td>   -1.093</td> <td>   -0.043</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ca]</th> <td>   -1.5095</td> <td>    0.304</td> <td>   -4.960</td> <td> 0.000</td> <td>   -2.109</td> <td>   -0.910</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.co]</th> <td>   -1.4843</td> <td>    0.287</td> <td>   -5.165</td> <td> 0.000</td> <td>   -2.050</td> <td>   -0.919</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ct]</th> <td>   -1.8623</td> <td>    0.281</td> <td>   -6.638</td> <td> 0.000</td> <td>   -2.414</td> <td>   -1.310</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.de]</th> <td>   -1.3076</td> <td>    0.294</td> <td>   -4.448</td> <td> 0.000</td> <td>   -1.886</td> <td>   -0.729</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.fl]</th> <td>   -0.2681</td> <td>    0.139</td> <td>   -1.924</td> <td> 0.055</td> <td>   -0.542</td> <td>    0.006</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ga]</th> <td>    0.5246</td> <td>    0.184</td> <td>    2.852</td> <td> 0.005</td> <td>    0.163</td> <td>    0.887</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ia]</th> <td>   -1.5439</td> <td>    0.253</td> <td>   -6.092</td> <td> 0.000</td> <td>   -2.043</td> <td>   -1.045</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.id]</th> <td>   -0.6690</td> <td>    0.258</td> <td>   -2.593</td> <td> 0.010</td> <td>   -1.177</td> <td>   -0.161</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.il]</th> <td>   -1.9616</td> <td>    0.291</td> <td>   -6.730</td> <td> 0.000</td> <td>   -2.535</td> <td>   -1.388</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.in]</th> <td>   -1.4615</td> <td>    0.273</td> <td>   -5.363</td> <td> 0.000</td> <td>   -1.998</td> <td>   -0.925</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ks]</th> <td>   -1.2232</td> <td>    0.245</td> <td>   -4.984</td> <td> 0.000</td> <td>   -1.706</td> <td>   -0.740</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ky]</th> <td>   -1.2175</td> <td>    0.287</td> <td>   -4.240</td> <td> 0.000</td> <td>   -1.783</td> <td>   -0.652</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.la]</th> <td>   -0.8471</td> <td>    0.189</td> <td>   -4.490</td> <td> 0.000</td> <td>   -1.218</td> <td>   -0.476</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ma]</th> <td>   -2.1097</td> <td>    0.276</td> <td>   -7.641</td> <td> 0.000</td> <td>   -2.653</td> <td>   -1.566</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.md]</th> <td>   -1.7064</td> <td>    0.283</td> <td>   -6.025</td> <td> 0.000</td> <td>   -2.264</td> <td>   -1.149</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.me]</th> <td>   -1.1079</td> <td>    0.191</td> <td>   -5.797</td> <td> 0.000</td> <td>   -1.484</td> <td>   -0.732</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.mi]</th> <td>   -1.4845</td> <td>    0.236</td> <td>   -6.290</td> <td> 0.000</td> <td>   -1.949</td> <td>   -1.020</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.mn]</th> <td>   -1.8972</td> <td>    0.265</td> <td>   -7.157</td> <td> 0.000</td> <td>   -2.419</td> <td>   -1.375</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.mo]</th> <td>   -1.2963</td> <td>    0.267</td> <td>   -4.861</td> <td> 0.000</td> <td>   -1.821</td> <td>   -0.771</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ms]</th> <td>   -0.0291</td> <td>    0.148</td> <td>   -0.196</td> <td> 0.845</td> <td>   -0.321</td> <td>    0.263</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.mt]</th> <td>   -0.3604</td> <td>    0.264</td> <td>   -1.365</td> <td> 0.173</td> <td>   -0.880</td> <td>    0.159</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.nc]</th> <td>   -0.2905</td> <td>    0.120</td> <td>   -2.424</td> <td> 0.016</td> <td>   -0.526</td> <td>   -0.055</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.nd]</th> <td>   -1.6234</td> <td>    0.254</td> <td>   -6.396</td> <td> 0.000</td> <td>   -2.123</td> <td>   -1.124</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ne]</th> <td>   -1.5222</td> <td>    0.249</td> <td>   -6.106</td> <td> 0.000</td> <td>   -2.013</td> <td>   -1.032</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.nh]</th> <td>   -1.2545</td> <td>    0.210</td> <td>   -5.983</td> <td> 0.000</td> <td>   -1.667</td> <td>   -0.842</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.nj]</th> <td>   -2.1057</td> <td>    0.307</td> <td>   -6.855</td> <td> 0.000</td> <td>   -2.710</td> <td>   -1.501</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.nm]</th> <td>    0.4264</td> <td>    0.254</td> <td>    1.677</td> <td> 0.095</td> <td>   -0.074</td> <td>    0.927</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.nv]</th> <td>   -0.6008</td> <td>    0.286</td> <td>   -2.101</td> <td> 0.037</td> <td>   -1.164</td> <td>   -0.038</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ny]</th> <td>   -2.1867</td> <td>    0.299</td> <td>   -7.316</td> <td> 0.000</td> <td>   -2.775</td> <td>   -1.598</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.oh]</th> <td>   -1.6744</td> <td>    0.254</td> <td>   -6.597</td> <td> 0.000</td> <td>   -2.174</td> <td>   -1.175</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ok]</th> <td>   -0.5451</td> <td>    0.169</td> <td>   -3.223</td> <td> 0.001</td> <td>   -0.878</td> <td>   -0.212</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.or]</th> <td>   -1.1680</td> <td>    0.286</td> <td>   -4.088</td> <td> 0.000</td> <td>   -1.730</td> <td>   -0.606</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.pa]</th> <td>   -1.7675</td> <td>    0.276</td> <td>   -6.402</td> <td> 0.000</td> <td>   -2.311</td> <td>   -1.224</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ri]</th> <td>   -2.2651</td> <td>    0.294</td> <td>   -7.711</td> <td> 0.000</td> <td>   -2.843</td> <td>   -1.687</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.sc]</th> <td>    0.5572</td> <td>    0.110</td> <td>    5.065</td> <td> 0.000</td> <td>    0.341</td> <td>    0.774</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.sd]</th> <td>   -1.0037</td> <td>    0.210</td> <td>   -4.788</td> <td> 0.000</td> <td>   -1.416</td> <td>   -0.591</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.tn]</th> <td>   -0.8757</td> <td>    0.268</td> <td>   -3.267</td> <td> 0.001</td> <td>   -1.403</td> <td>   -0.348</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.tx]</th> <td>   -0.9175</td> <td>    0.246</td> <td>   -3.736</td> <td> 0.000</td> <td>   -1.401</td> <td>   -0.434</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.ut]</th> <td>   -1.1640</td> <td>    0.196</td> <td>   -5.926</td> <td> 0.000</td> <td>   -1.551</td> <td>   -0.777</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.va]</th> <td>   -1.2902</td> <td>    0.204</td> <td>   -6.320</td> <td> 0.000</td> <td>   -1.692</td> <td>   -0.888</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.vt]</th> <td>   -0.9660</td> <td>    0.211</td> <td>   -4.576</td> <td> 0.000</td> <td>   -1.382</td> <td>   -0.550</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.wa]</th> <td>   -1.6595</td> <td>    0.283</td> <td>   -5.854</td> <td> 0.000</td> <td>   -2.217</td> <td>   -1.102</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.wi]</th> <td>   -1.7593</td> <td>    0.294</td> <td>   -5.985</td> <td> 0.000</td> <td>   -2.338</td> <td>   -1.181</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.wv]</th> <td>   -0.8968</td> <td>    0.247</td> <td>   -3.636</td> <td> 0.000</td> <td>   -1.382</td> <td>   -0.411</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>C(state)[T.wy]</th> <td>   -0.2285</td> <td>    0.313</td> <td>   -0.730</td> <td> 0.466</td> <td>   -0.844</td> <td>    0.387</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>beertax</th>        <td>   -0.6559</td> <td>    0.188</td> <td>   -3.491</td> <td> 0.001</td> <td>   -1.026</td> <td>   -0.286</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>53.045</td> <th>  Durbin-Watson:     </th> <td>   1.517</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 219.863</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>          <td> 0.585</td> <th>  Prob(JB):          </th> <td>1.81e-48</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>      <td> 6.786</td> <th>  Cond. No.          </th> <td>    187.</td>\n",
       "</tr>\n",
       "</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:               fat_rate   R-squared:                       0.905\n",
       "Model:                            OLS   Adj. R-squared:                  0.889\n",
       "Method:                 Least Squares   F-statistic:                     56.97\n",
       "Date:                Tue, 18 Feb 2020   Prob (F-statistic):          1.96e-120\n",
       "Time:                        20:13:24   Log-Likelihood:                 107.97\n",
       "No. Observations:                 336   AIC:                            -117.9\n",
       "Df Residuals:                     287   BIC:                             69.09\n",
       "Df Model:                          48                                         \n",
       "Covariance Type:            nonrobust                                         \n",
       "==================================================================================\n",
       "                     coef    std err          t      P>|t|      [0.025      0.975]\n",
       "----------------------------------------------------------------------------------\n",
       "Intercept          3.4776      0.313     11.098      0.000       2.861       4.094\n",
       "C(state)[T.ar]    -0.6550      0.219     -2.990      0.003      -1.086      -0.224\n",
       "C(state)[T.az]    -0.5677      0.267     -2.129      0.034      -1.093      -0.043\n",
       "C(state)[T.ca]    -1.5095      0.304     -4.960      0.000      -2.109      -0.910\n",
       "C(state)[T.co]    -1.4843      0.287     -5.165      0.000      -2.050      -0.919\n",
       "C(state)[T.ct]    -1.8623      0.281     -6.638      0.000      -2.414      -1.310\n",
       "C(state)[T.de]    -1.3076      0.294     -4.448      0.000      -1.886      -0.729\n",
       "C(state)[T.fl]    -0.2681      0.139     -1.924      0.055      -0.542       0.006\n",
       "C(state)[T.ga]     0.5246      0.184      2.852      0.005       0.163       0.887\n",
       "C(state)[T.ia]    -1.5439      0.253     -6.092      0.000      -2.043      -1.045\n",
       "C(state)[T.id]    -0.6690      0.258     -2.593      0.010      -1.177      -0.161\n",
       "C(state)[T.il]    -1.9616      0.291     -6.730      0.000      -2.535      -1.388\n",
       "C(state)[T.in]    -1.4615      0.273     -5.363      0.000      -1.998      -0.925\n",
       "C(state)[T.ks]    -1.2232      0.245     -4.984      0.000      -1.706      -0.740\n",
       "C(state)[T.ky]    -1.2175      0.287     -4.240      0.000      -1.783      -0.652\n",
       "C(state)[T.la]    -0.8471      0.189     -4.490      0.000      -1.218      -0.476\n",
       "C(state)[T.ma]    -2.1097      0.276     -7.641      0.000      -2.653      -1.566\n",
       "C(state)[T.md]    -1.7064      0.283     -6.025      0.000      -2.264      -1.149\n",
       "C(state)[T.me]    -1.1079      0.191     -5.797      0.000      -1.484      -0.732\n",
       "C(state)[T.mi]    -1.4845      0.236     -6.290      0.000      -1.949      -1.020\n",
       "C(state)[T.mn]    -1.8972      0.265     -7.157      0.000      -2.419      -1.375\n",
       "C(state)[T.mo]    -1.2963      0.267     -4.861      0.000      -1.821      -0.771\n",
       "C(state)[T.ms]    -0.0291      0.148     -0.196      0.845      -0.321       0.263\n",
       "C(state)[T.mt]    -0.3604      0.264     -1.365      0.173      -0.880       0.159\n",
       "C(state)[T.nc]    -0.2905      0.120     -2.424      0.016      -0.526      -0.055\n",
       "C(state)[T.nd]    -1.6234      0.254     -6.396      0.000      -2.123      -1.124\n",
       "C(state)[T.ne]    -1.5222      0.249     -6.106      0.000      -2.013      -1.032\n",
       "C(state)[T.nh]    -1.2545      0.210     -5.983      0.000      -1.667      -0.842\n",
       "C(state)[T.nj]    -2.1057      0.307     -6.855      0.000      -2.710      -1.501\n",
       "C(state)[T.nm]     0.4264      0.254      1.677      0.095      -0.074       0.927\n",
       "C(state)[T.nv]    -0.6008      0.286     -2.101      0.037      -1.164      -0.038\n",
       "C(state)[T.ny]    -2.1867      0.299     -7.316      0.000      -2.775      -1.598\n",
       "C(state)[T.oh]    -1.6744      0.254     -6.597      0.000      -2.174      -1.175\n",
       "C(state)[T.ok]    -0.5451      0.169     -3.223      0.001      -0.878      -0.212\n",
       "C(state)[T.or]    -1.1680      0.286     -4.088      0.000      -1.730      -0.606\n",
       "C(state)[T.pa]    -1.7675      0.276     -6.402      0.000      -2.311      -1.224\n",
       "C(state)[T.ri]    -2.2651      0.294     -7.711      0.000      -2.843      -1.687\n",
       "C(state)[T.sc]     0.5572      0.110      5.065      0.000       0.341       0.774\n",
       "C(state)[T.sd]    -1.0037      0.210     -4.788      0.000      -1.416      -0.591\n",
       "C(state)[T.tn]    -0.8757      0.268     -3.267      0.001      -1.403      -0.348\n",
       "C(state)[T.tx]    -0.9175      0.246     -3.736      0.000      -1.401      -0.434\n",
       "C(state)[T.ut]    -1.1640      0.196     -5.926      0.000      -1.551      -0.777\n",
       "C(state)[T.va]    -1.2902      0.204     -6.320      0.000      -1.692      -0.888\n",
       "C(state)[T.vt]    -0.9660      0.211     -4.576      0.000      -1.382      -0.550\n",
       "C(state)[T.wa]    -1.6595      0.283     -5.854      0.000      -2.217      -1.102\n",
       "C(state)[T.wi]    -1.7593      0.294     -5.985      0.000      -2.338      -1.181\n",
       "C(state)[T.wv]    -0.8968      0.247     -3.636      0.000      -1.382      -0.411\n",
       "C(state)[T.wy]    -0.2285      0.313     -0.730      0.466      -0.844       0.387\n",
       "beertax           -0.6559      0.188     -3.491      0.001      -1.026      -0.286\n",
       "==============================================================================\n",
       "Omnibus:                       53.045   Durbin-Watson:                   1.517\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):              219.863\n",
       "Skew:                           0.585   Prob(JB):                     1.81e-48\n",
       "Kurtosis:                       6.786   Cond. No.                         187.\n",
       "==============================================================================\n",
       "\n",
       "Warnings:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "\"\"\""
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "smf.ols('fat_rate ~ beertax + C(state)', df).fit().summary()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 6\n",
    "\n",
    "Explain whey your results in Exercises 4 (without fixed effects) and Exercise 5 (with state fixed effects) look so different. What does this imply about states with high beer taxes?"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Fixed Effects by Demeaning\n",
    "\n",
    "Rather than just add indicator variables, we'll now use a different strategy for estimating fixed effects called an \"entity-demeaning.\" This method is more computationally efficient, and can also help you understand how fixed effects work. \n",
    "\n",
    "Let's begin by assuming we want to estimate the following fixed-effect model:\n",
    "\n",
    "\\begin{align}\n",
    "FatalityRate_{it} = \\beta BeerTax_{it} + Z_i + \\epsilon_{it} \\tag{1}\n",
    "\\end{align}\n",
    "\n",
    "Where $FatalityRate_{it}$ is the fatality rate of state $i$ in year $t$, $\\beta BeerTax_{it}$ is the beer tax of state $i$ in year $t$. $Z_i$ is a state fixed effect.\n",
    "\n",
    "Rather than adding indicator variables, however, we'll use entity-demean as follows: \n",
    "\n",
    "First, we take the average on both sides of the regression. Here $n$ is the number of periods. \n",
    "\n",
    "\\begin{align*}\n",
    "\\frac{1}{n} \\sum_{i=1}^n FatalityRate_{it} =& \\, \\beta_1 \\frac{1}{n} \\sum_{i=1}^n BeerTax_{it} + \\frac{1}{n} \\sum_{i=1}^n Z_i + \\frac{1}{n} \\sum_{i=1}^n \\epsilon_{it} \\\\\n",
    "\\overline{FatalityRate} =& \\, \\beta_1 \\overline{BeerTax}_i + Z_i + \\overline{\\epsilon}_i.  \\tag{2}\n",
    "\\end{align*}\n",
    "\n",
    "Substracting the  from the main equation yields:\n",
    "\n",
    "\\begin{align}\n",
    "\\begin{split}\n",
    "FatalityRate_{it} - \\overline{FatalityRate}_i =& \\, \\beta_1(BeerTax_{it}-\\overline{BeerTax}_i) + (u_{it} - \\overline{u}_i) \\\\\n",
    "\\overset{\\sim}{FatalityRate}_{it} =& \\, \\beta_1 \\overset{\\sim}{BeerTax}_{it} + \\overset{\\sim}{u}_{it}. \n",
    "\\end{split} \n",
    "\\end{align}\n",
    "\n",
    "By taking the difference between the value of each observation (state-year) and the mean value of the entity (state) over n periods, we analyze how the within-state variation of beer tax affects that of the fatality rate. Moreover, by doing so we no longer need to estimate the fixed effects of $Z_i$, saving computing power if we are working on a dataset with a large number of fixed effects."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 6\n",
    "\n",
    "Implement the above entity-demeaned approach to estimate the fixed-effects model by hand (use basic functions, not full tools like `PanelOLS` or `C()` notation in `python`, or `lfe` or `C()` notation in `R`). "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"simpletable\">\n",
       "<caption>OLS Regression Results</caption>\n",
       "<tr>\n",
       "  <th>Dep. Variable:</th>       <td>fat_rate_dm</td>   <th>  R-squared:         </th> <td>   0.041</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.038</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   14.19</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Date:</th>             <td>Tue, 18 Feb 2020</td> <th>  Prob (F-statistic):</th> <td>0.000196</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Time:</th>                 <td>20:13:24</td>     <th>  Log-Likelihood:    </th> <td>  107.97</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>No. Observations:</th>      <td>   336</td>      <th>  AIC:               </th> <td>  -211.9</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Residuals:</th>          <td>   334</td>      <th>  BIC:               </th> <td>  -204.3</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Intercept</th>  <td>-1.735e-17</td> <td>    0.010</td> <td>-1.81e-15</td> <td> 1.000</td> <td>   -0.019</td> <td>    0.019</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>beertax_dm</th> <td>   -0.6559</td> <td>    0.174</td> <td>   -3.767</td> <td> 0.000</td> <td>   -0.998</td> <td>   -0.313</td>\n",
       "</tr>\n",
       "</table>\n",
       "<table class=\"simpletable\">\n",
       "<tr>\n",
       "  <th>Omnibus:</th>       <td>53.045</td> <th>  Durbin-Watson:     </th> <td>   1.517</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td> 219.863</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Skew:</th>          <td> 0.585</td> <th>  Prob(JB):          </th> <td>1.81e-48</td>\n",
       "</tr>\n",
       "<tr>\n",
       "  <th>Kurtosis:</th>      <td> 6.786</td> <th>  Cond. No.          </th> <td>    18.1</td>\n",
       "</tr>\n",
       "</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified."
      ],
      "text/plain": [
       "<class 'statsmodels.iolib.summary.Summary'>\n",
       "\"\"\"\n",
       "                            OLS Regression Results                            \n",
       "==============================================================================\n",
       "Dep. Variable:            fat_rate_dm   R-squared:                       0.041\n",
       "Model:                            OLS   Adj. R-squared:                  0.038\n",
       "Method:                 Least Squares   F-statistic:                     14.19\n",
       "Date:                Tue, 18 Feb 2020   Prob (F-statistic):           0.000196\n",
       "Time:                        20:13:24   Log-Likelihood:                 107.97\n",
       "No. Observations:                 336   AIC:                            -211.9\n",
       "Df Residuals:                     334   BIC:                            -204.3\n",
       "Df Model:                           1                                         \n",
       "Covariance Type:            nonrobust                                         \n",
       "==============================================================================\n",
       "                 coef    std err          t      P>|t|      [0.025      0.975]\n",
       "------------------------------------------------------------------------------\n",
       "Intercept  -1.735e-17      0.010  -1.81e-15      1.000      -0.019       0.019\n",
       "beertax_dm    -0.6559      0.174     -3.767      0.000      -0.998      -0.313\n",
       "==============================================================================\n",
       "Omnibus:                       53.045   Durbin-Watson:                   1.517\n",
       "Prob(Omnibus):                  0.000   Jarque-Bera (JB):              219.863\n",
       "Skew:                           0.585   Prob(JB):                     1.81e-48\n",
       "Kurtosis:                       6.786   Cond. No.                         18.1\n",
       "==============================================================================\n",
       "\n",
       "Warnings:\n",
       "[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n",
       "\"\"\""
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# get demeaned variables\n",
    "df['beertax_dm'] = df['beertax'] -  df.groupby('state').beertax.transform('mean')\n",
    "df['fat_rate_dm'] = df['fat_rate']  -  df.groupby('state').fat_rate.transform('mean')\n",
    "\n",
    "# perform ols\n",
    "smf.ols('fat_rate_dm ~ beertax_dm', df).fit().summary() # it should be the same as the output using PanelOls"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 7 \n",
    "\n",
    "Fit the model with state fixed-effect using `PanelOLS` / `lfe`. Compare it to your by-hand output. Interpret the result."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = df.set_index(['state', 'year'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                          PanelOLS Estimation Summary                           \n",
      "================================================================================\n",
      "Dep. Variable:               fat_rate   R-squared:                        0.0407\n",
      "Estimator:                   PanelOLS   R-squared (Between):             -0.3805\n",
      "No. Observations:                 336   R-squared (Within):               0.0407\n",
      "Date:                Tue, Feb 18 2020   R-squared (Overall):             -0.3775\n",
      "Time:                        20:13:24   Log-likelihood                    107.97\n",
      "Cov. Estimator:            Unadjusted                                           \n",
      "                                        F-statistic:                      12.190\n",
      "Entities:                          48   P-value                           0.0006\n",
      "Avg Obs:                       7.0000   Distribution:                   F(1,287)\n",
      "Min Obs:                       7.0000                                           \n",
      "Max Obs:                       7.0000   F-statistic (robust):             12.190\n",
      "                                        P-value                           0.0006\n",
      "Time periods:                       7   Distribution:                   F(1,287)\n",
      "Avg Obs:                       48.000                                           \n",
      "Min Obs:                       48.000                                           \n",
      "Max Obs:                       48.000                                           \n",
      "                                                                                \n",
      "                             Parameter Estimates                              \n",
      "==============================================================================\n",
      "            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI\n",
      "------------------------------------------------------------------------------\n",
      "beertax       -0.6559     0.1878    -3.4915     0.0006     -1.0256     -0.2861\n",
      "==============================================================================\n",
      "\n",
      "F-test for Poolability: 52.179\n",
      "P-value: 0.0000\n",
      "Distribution: F(47,287)\n",
      "\n",
      "Included effects: Entity\n"
     ]
    }
   ],
   "source": [
    "from linearmodels import PanelOLS\n",
    "\n",
    "# model with state fixed effect\n",
    "mod = PanelOLS.from_formula('fat_rate ~ beertax + EntityEffects',\n",
    "                            data=df)\n",
    "print(mod.fit())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercise 8\n",
    "\n",
    "Now (using `PanelOLS` or `lfe`) estimate a fixed effects model using the following specification. Add fixed effects for **both** the state and the year, as well as the other covariates you think are important $X_{it}$). \n",
    "\n",
    "Explain (a) the type of phenomenon we control for by adding `year` fixed effects, and (b) your choice of covariates. Cluster the standard error at the state level. Interpret the result.\n",
    "\n",
    "\\begin{align}\n",
    "FatalityRate_{it} = \\beta BeerTax_{it} + X_{it} + State_i + Year_t + \\epsilon_{it}\n",
    "\\end{align}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                          PanelOLS Estimation Summary                           \n",
      "================================================================================\n",
      "Dep. Variable:               fat_rate   R-squared:                        0.0361\n",
      "Estimator:                   PanelOLS   R-squared (Between):             -0.3701\n",
      "No. Observations:                 336   R-squared (Within):               0.0407\n",
      "Date:                Tue, Feb 18 2020   R-squared (Overall):             -0.3672\n",
      "Time:                        20:13:24   Log-likelihood                    115.04\n",
      "Cov. Estimator:             Clustered                                           \n",
      "                                        F-statistic:                      10.513\n",
      "Entities:                          48   P-value                           0.0013\n",
      "Avg Obs:                       7.0000   Distribution:                   F(1,281)\n",
      "Min Obs:                       7.0000                                           \n",
      "Max Obs:                       7.0000   F-statistic (robust):             2.8021\n",
      "                                        P-value                           0.0953\n",
      "Time periods:                       7   Distribution:                   F(1,281)\n",
      "Avg Obs:                       48.000                                           \n",
      "Min Obs:                       48.000                                           \n",
      "Max Obs:                       48.000                                           \n",
      "                                                                                \n",
      "                             Parameter Estimates                              \n",
      "==============================================================================\n",
      "            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI\n",
      "------------------------------------------------------------------------------\n",
      "beertax       -0.6400     0.3823    -1.6740     0.0953     -1.3925      0.1126\n",
      "==============================================================================\n",
      "\n",
      "F-test for Poolability: 47.479\n",
      "P-value: 0.0000\n",
      "Distribution: F(53,281)\n",
      "\n",
      "Included effects: Entity, Time\n"
     ]
    }
   ],
   "source": [
    "# model with state and year fixed effect effects\n",
    "mod = PanelOLS.from_formula('fat_rate ~ beertax + EntityEffects + TimeEffects',\n",
    "                            data=df)\n",
    "print(mod.fit(cov_type='clustered', cluster_entity=True))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
