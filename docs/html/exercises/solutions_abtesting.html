<!DOCTYPE html> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.17.1: http://docutils.sourceforge.net/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../_static/javascripts/modernizr.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-151397036-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-151397036-1'); </script> <title>A/B Testing the Udacity Website &#8212; Unifying Data Science</title> <link rel=stylesheet  type="text/css" href="../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../_static/material.css" /> <script data-url_root="../" id=documentation_options  src="../_static/documentation_options.js"></script> <script src="../_static/jquery.js"></script> <script src="../_static/underscore.js"></script> <script src="../_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script async=async  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <link rel="shortcut icon" href="../_static/mids_logo.svg"/> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <body dir=ltr data-md-color-primary=blue-grey data-md-color-accent=blue> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#exercises/solutions_abtesting" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title="Unifying Data Science" class="md-header-nav__button md-logo"> <img src="../_static/mids_logo.svg" height=26  alt="Unifying Data Science logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >Unifying Data Science</span> <span class=md-header-nav__topic > A/B Testing the Udacity Website </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <script src="../_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../"versions.json"", target_loc = "../../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../index.html" class=md-tabs__link >Home</a> <li class=md-tabs__item ><a href="../class_schedule.html" class=md-tabs__link >Class Schedule</a> <li class=md-tabs__item ><a href="../topic_list.html" class=md-tabs__link >Topic List</a> <li class=md-tabs__item ><a href="https://www.nickeubank.com" class=md-tabs__link >About The Author</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title="Unifying Data Science" class="md-nav__button md-logo"> <img src="../_static/mids_logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../index.html" title="Unifying Data Science">Unifying Data Science</a> </label> <ul class=md-nav__list > <li class=md-nav__item > <a href="../class_schedule.html" class=md-nav__link >CLASS SCHEDULE</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Data Science Concepts</span></span> <li class=md-nav__item > <a href="../taxonomy_of_questions.html" class=md-nav__link >Taxonomy of Questions</a> <li class=md-nav__item > <a href="../moving_from_problems_to_questions.html" class=md-nav__link >From Problems to Questions</a> <li class=md-nav__item > <a href="../descriptive_questions.html" class=md-nav__link >Discretion and Description</a> <li class=md-nav__item > <a href="../ethical_ml_recommendations.html" class=md-nav__link >Ethical Machine Learning</a> <li class=md-nav__item > <a href="../writing_to_stakeholders.html" class=md-nav__link >Writing for Lay Audiences</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Causal Inference</span></span> <li class=md-nav__item > <a href="../limitations_of_ATE.html" class=md-nav__link >Limitations of ATE</a> <li class=md-nav__item > <a href="../internal_v_external_validity.html" class=md-nav__link >Internal v. External Validity</a> <li class=md-nav__item > <a href="../evaluating_real_studies.html" class=md-nav__link >Evaluating A Real Study</a> <li class=md-nav__item > <a href="../matching_why.html" class=md-nav__link >Matching (Why)</a> <li class=md-nav__item > <a href="../matching_how.html" class=md-nav__link >Matching (How)</a> <li class=md-nav__item > <a href="../interpreting_indicator_vars.html" class=md-nav__link >Indicator Variables</a> <li class=md-nav__item > <a href="../fixed_effects.html" class=md-nav__link >Fixed Effects (FEs)</a> <li class=md-nav__item > <a href="../fixed_effects_and_causal_inference.html" class=md-nav__link >FEs & Causality</a> <li class=md-nav__item > <a href="../fixed_effects_v_hierarchical.html" class=md-nav__link >FEs & Hierarchical Models</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#exercises-solutions-abtesting--page-root" class=md-nav__link >A/B Testing the Udacity Website</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Udacity’s-Test" class=md-nav__link >Udacity’s Test</a> <li class=md-nav__item ><a href="#Import-the-Data" class=md-nav__link >Import the Data</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Exercise-1" class=md-nav__link >Exercise 1</a> <li class=md-nav__item ><a href="#Exercise-2" class=md-nav__link >Exercise 2</a> </ul> </nav> <li class=md-nav__item ><a href="#Pick-your-measures" class=md-nav__link >Pick your measures</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Exercise-3" class=md-nav__link >Exercise 3</a> <li class=md-nav__item ><a href="#Exercise-4" class=md-nav__link >Exercise 4</a> </ul> </nav> <li class=md-nav__item ><a href="#Validating-The-Data" class=md-nav__link >Validating The Data</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Exercise-5" class=md-nav__link >Exercise 5</a> <li class=md-nav__item ><a href="#Exercise-6" class=md-nav__link >Exercise 6</a> <li class=md-nav__item ><a href="#Exercise-7" class=md-nav__link >Exercise 7</a> <li class=md-nav__item ><a href="#Exercise-8" class=md-nav__link >Exercise 8</a> </ul> </nav> <li class=md-nav__item ><a href="#Estimating-the-Effect-of-Experiment" class=md-nav__link >Estimating the Effect of Experiment</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Exercise-9" class=md-nav__link >Exercise 9</a> <li class=md-nav__item ><a href="#Exercise-10" class=md-nav__link >Exercise 10</a> <li class=md-nav__item ><a href="#Exercise-11" class=md-nav__link >Exercise 11</a> <li class=md-nav__item ><a href="#Exercise-12" class=md-nav__link >Exercise 12</a> <li class=md-nav__item ><a href="#Exercise-13" class=md-nav__link >Exercise 13</a> </ul> </nav> </ul> </nav> </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container div.prompt *, div.nboutput.container div.prompt *, div.nbinput.container div.input_area pre, div.nboutput.container div.output_area pre, div.nbinput.container div.input_area .highlight, div.nboutput.container div.output_area .highlight { border: none; padding: 0; margin: 0; box-shadow: none; } div.nbinput.container > div[class*=highlight], div.nboutput.container > div[class*=highlight] { margin: 0; } div.nbinput.container div.prompt *, div.nboutput.container div.prompt * { background: none; } div.nboutput.container div.output_area .highlight, div.nboutput.container div.output_area pre { background: unset; } div.nboutput.container div.output_area div.highlight { color: unset; /* override Pygments text color */ } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: 4.5ex; padding-top: 5px; position: relative; user-select: none; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: absolute; right: 0; margin-right: 0.3ex; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: unset; text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: unset; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; /*background: #f5f5f5;*/ } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 5px; margin: 0; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt a.copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } div.rendered_html th { font-weight: bold; } div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <section id="A/B-Testing-the-Udacity-Website"> <h1 id=exercises-solutions-abtesting--page-root >A/B Testing the Udacity Website<a class=headerlink  href="#exercises-solutions-abtesting--page-root" title="Permalink to this headline">¶</a></h1> <p>In these exercises, we’ll be analyzing data on user behavior from an experiment run by Udacity, the online education company. More specifically, we’ll be looking at a test Udacity ran to improve the onboarding process on their site.</p> <p>Udacity’s test is an example of an “A/B” test, in which some portion of users visiting a website (or using an app) are randomly selected to see a new version of the site. An analyst can then compare the behavior of users who see a new website design to users seeing their normal website to estimate the effect of rolling out the proposed changes to all users. While this kind of experiment has it’s own name in industry (A/B testing), to be clear it’s just a randomized experiment, and so everything we’ve learned about potential outcomes and randomized experiments apply here.</p> <p>(Udacity has generously provides the data from this test under an Apache open-source license, and you can find their <a class="reference external" href="https://www.kaggle.com/tammyrotem/ab-tests-with-python/notebook">original writeup here</a>. If you’re interested in learning more on A/B testing in particular, it seems only fair while we use their data to flag they have a full course on the subject <a class="reference external" href="https://www.udacity.com/course/ab-testing--ud257">here</a>.)</p> <section id="Udacity’s-Test"> <h2 id="Udacity’s-Test">Udacity’s Test<a class=headerlink  href="#Udacity’s-Test" title="Permalink to this headline">¶</a></h2> <p>The test <a class="reference external" href="https://www.kaggle.com/tammyrotem/ab-tests-with-python/notebook">is described by Udacity as follows</a>:</p> <p>At the time of this experiment, Udacity courses currently have two options on the course overview page: “start free trial”, and “access course materials”.</p> <p><strong>Current Conditions Before Change</strong></p> <ul class=simple > <li><p>If the student clicks “start free trial”, they will be asked to enter their credit card information, and then they will be enrolled in a free trial for the paid version of the course. After 14 days, they will automatically be charged unless they cancel first.</p> <li><p>If the student clicks “access course materials”, they will be able to view the videos and take the quizzes for free, but they will not receive coaching support or a verified certificate, and they will not submit their final project for feedback.</p> </ul> <p><strong>Description of Experimented Change</strong></p> <ul class=simple > <li><p>In the experiment, Udacity tested a change where if the student clicked “start free trial”, they were asked how much time they had available to devote to the course.</p> <li><p>If the student indicated 5 or more hours per week, they would be taken through the checkout process as usual. If they indicated fewer than 5 hours per week, a message would appear indicating that Udacity courses usually require a greater time commitment for successful completion, and suggesting that the student might like to access the course materials for free.</p> <li><p>At this point, the student would have the option to continue enrolling in the free trial, or access the course materials for free instead. This <a class="reference external" href="images/udacity_checkyoureready.png">screenshot</a> shows what the experiment looks like.</p> </ul> <p><strong>Udacity’s Hope is that…</strong>:</p> <blockquote> <div><p>this might set clearer expectations for students upfront, thus reducing the number of frustrated students who left the free trial because they didn’t have enough time – without significantly reducing the number of students to continue past the free trial and eventually complete the course. If this hypothesis held true, Udacity could improve the overall student experience and improve coaches’ capacity to support students who are likely to complete the course.</p> </div></blockquote> </section> <section id=Import-the-Data > <h2 id=Import-the-Data >Import the Data<a class=headerlink  href="#Import-the-Data" title="Permalink to this headline">¶</a></h2> <section id=Exercise-1 > <h3 id=Exercise-1 >Exercise 1<a class=headerlink  href="#Exercise-1" title="Permalink to this headline">¶</a></h3> <p>Begin by importing Udacity’s data on user behavior by going to <a class="reference external" href="http://www.github/nickeubank/MIDS_Data/">http://www.github/nickeubank/MIDS_Data/</a> and using the <code class="docutils literal notranslate"><span class=pre >udacity_AB_testing</span></code>folder, or by clicking <a class="reference external" href="https://github.com/nickeubank/MIDS_Data/tree/master/udacity_AB_testing">here.</a> Note that there are TWO datasets for this test – one for the control data (users who saw the original design), and one for treatment data (users who saw the experimental design). Udacity decided to show their test site to 1/2 of visitors, so there are roughly the same number of users appearing in each dataset (though this is not a requirement of AB tests).</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># First, load pandas and an extension that</span>
<span class=c1 ># applies Black formatting to all cells.</span>

<span class=o >%</span><span class=k >load_ext</span> lab_black
<span class=kn >import</span> <span class=nn >pandas</span> <span class=k >as</span> <span class=nn >pd</span>
</pre></div> </div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >control</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >read_csv</span><span class=p >(</span>
    <span class=s2 >"https://media.githubusercontent.com/media/nickeubank/"</span>
    <span class=s2 >"MIDS_Data/master/udacity_AB_testing/control_data.csv"</span>
<span class=p >)</span>
<span class=n >treat</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >read_csv</span><span class=p >(</span>
    <span class=s2 >"https://media.githubusercontent.com/media/nickeubank/"</span>
    <span class=s2 >"MIDS_Data/master/udacity_AB_testing/experiment_data.csv"</span>
<span class=p >)</span>
</pre></div> </div> </div> </section> <section id=Exercise-2 > <h3 id=Exercise-2 >Exercise 2<a class=headerlink  href="#Exercise-2" title="Permalink to this headline">¶</a></h3> <p>Explore the data. Can you identifying the unit of observation of the data (e.g. what is represented by each row)?</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Each row is a single day of behavior for each treatment arm.</span>
</pre></div> </div> </div> </section> </section> <section id=Pick-your-measures > <h2 id=Pick-your-measures >Pick your measures<a class=headerlink  href="#Pick-your-measures" title="Permalink to this headline">¶</a></h2> <section id=Exercise-3 > <h3 id=Exercise-3 >Exercise 3<a class=headerlink  href="#Exercise-3" title="Permalink to this headline">¶</a></h3> <p>The easiest way to analyze this data is to stack it into a single dataset where each observation is a day-treatment-arm (so you should end up with two rows per day, one for those who are in the treated groups, and one for those who were in the control group). Note that currently nothing in the data identifies whether a given observation is a treatment group observation or a control group observation, so you’ll want to make sure to add a “treatment” indicator variable.</p> <p>The variables in the data are:</p> <ul class=simple > <li><p>Pageviews: number of unique users visiting homepage</p> <li><p>Clicks: number of those users clicking “Start Free Trial”</p> <li><p>Enrollments: Number of people enrolling in trial</p> <li><p>Payments: Number of people who eventually pay for the service</p> </ul> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >control</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >=</span> <span class=mi >0</span>
<span class=n >treat</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >=</span> <span class=mi >1</span>
<span class=n >users</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >concat</span><span class=p >([</span><span class=n >control</span><span class=p >,</span> <span class=n >treat</span><span class=p >])</span>
<span class=n >users</span><span class=o >.</span><span class=n >head</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>Date <th>Pageviews <th>Clicks <th>Enrollments <th>Payments <th>treatment <tr> <th>0 <td>Sat, Oct 11 <td>7723 <td>687 <td>134.0 <td>70.0 <td>0 <tr> <th>1 <td>Sun, Oct 12 <td>9102 <td>779 <td>147.0 <td>70.0 <td>0 <tr> <th>2 <td>Mon, Oct 13 <td>10511 <td>909 <td>167.0 <td>95.0 <td>0 <tr> <th>3 <td>Tue, Oct 14 <td>9871 <td>836 <td>156.0 <td>105.0 <td>0 <tr> <th>4 <td>Wed, Oct 15 <td>10014 <td>837 <td>163.0 <td>64.0 <td>0 </table> </div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >users</span><span class=o >.</span><span class=n >tail</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>Date <th>Pageviews <th>Clicks <th>Enrollments <th>Payments <th>treatment <tr> <th>32 <td>Wed, Nov 12 <td>10042 <td>802 <td>NaN <td>NaN <td>1 <tr> <th>33 <td>Thu, Nov 13 <td>9721 <td>829 <td>NaN <td>NaN <td>1 <tr> <th>34 <td>Fri, Nov 14 <td>9304 <td>770 <td>NaN <td>NaN <td>1 <tr> <th>35 <td>Sat, Nov 15 <td>8668 <td>724 <td>NaN <td>NaN <td>1 <tr> <th>36 <td>Sun, Nov 16 <td>8988 <td>710 <td>NaN <td>NaN <td>1 </table> </div></div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Make sure it worked well!</span>
<span class=k >assert</span> <span class=nb >len</span><span class=p >(</span><span class=n >users</span><span class=p >)</span> <span class=o >==</span> <span class=nb >len</span><span class=p >(</span><span class=n >control</span><span class=p >)</span> <span class=o >+</span> <span class=nb >len</span><span class=p >(</span><span class=n >treat</span><span class=p >)</span>
</pre></div> </div> </div> </section> <section id=Exercise-4 > <h3 id=Exercise-4 >Exercise 4<a class=headerlink  href="#Exercise-4" title="Permalink to this headline">¶</a></h3> <p>Given the outcomes of interest to Udacity, what outcomes do you want to measure? (In the language of the Potential Outcomes Framework, what are your <span class="math notranslate nohighlight">\(Y\)</span> variables?). Add these to your data.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Udacity wants a decline in the number of people</span>
<span class=c1 ># who enroll in a trial but don't</span>
<span class=c1 ># end up continuing (paying) at the end of the trial.</span>
<span class=c1 ># So first we want the number of enrollments that end in</span>
<span class=c1 ># non-payment per person who sees trial page.</span>

<span class=c1 ># Note that because "clicks" is pre-treatment</span>
<span class=c1 ># and we have the same number of people in both</span>
<span class=c1 ># treatment arms, on average we have the</span>
<span class=c1 ># same number of clicks in both groups</span>
<span class=c1 ># so you don't technically have to normalize.</span>

<span class=c1 ># It's also ok to just look at the share of Enrollments</span>
<span class=c1 ># that end up as payments.</span>

<span class=n >users</span><span class=p >[</span><span class=s2 >"enroll_but_nopayment_per_click"</span><span class=p >]</span> <span class=o >=</span> <span class=p >(</span>
    <span class=n >users</span><span class=p >[</span><span class=s2 >"Enrollments"</span><span class=p >]</span> <span class=o >-</span> <span class=n >users</span><span class=p >[</span><span class=s2 >"Payments"</span><span class=p >]</span>
<span class=p >)</span> <span class=o >/</span> <span class=n >users</span><span class=p >[</span><span class=s2 >"Clicks"</span><span class=p >]</span>

<span class=c1 ># Second, they don't want to see a decline in payments, so we also want to measure</span>
<span class=c1 ># the conversion rate from clicks to payments. Ideally, this won't change.</span>

<span class=c1 ># Again, dividing by clicks is optional.</span>

<span class=n >users</span><span class=p >[</span><span class=s2 >"payments_per_click"</span><span class=p >]</span> <span class=o >=</span> <span class=n >users</span><span class=p >[</span><span class=s2 >"Payments"</span><span class=p >]</span> <span class=o >/</span> <span class=n >users</span><span class=p >[</span><span class=s2 >"Clicks"</span><span class=p >]</span>
</pre></div> </div> </div> </section> </section> <section id=Validating-The-Data > <h2 id=Validating-The-Data >Validating The Data<a class=headerlink  href="#Validating-The-Data" title="Permalink to this headline">¶</a></h2> <section id=Exercise-5 > <h3 id=Exercise-5 >Exercise 5<a class=headerlink  href="#Exercise-5" title="Permalink to this headline">¶</a></h3> <p>Whenever you are working with experimental data, the first thing you want to do is verify that users actually were randomly sorted into the two arms of the experiment. In this data, half of users were supposed to be shown the old version of the site and half were supposed to see the new version.</p> <p><code class="docutils literal notranslate"><span class=pre >Pageviews</span></code> tells you how many unique users visited the welcome site we are experimenting on. <code class="docutils literal notranslate"><span class=pre >Pageviews</span></code> is what is sometimes called an “invariant” variable, meaning that it shouldn’t vary across treatment arms – after all, people have to visit the site before they get a chance to see the treatment, so there’s no way that being assigned to treatment or control should affect the number of pageviews assigned to each group.</p> <p>“Invariant” variables are also an example of what are known as a “pre-treatment” variable, because pageviews are determined before users are manipulated in any way. That makes it analogous to gender or age in experiments where you have demographic data – a person’s age and gender are determined before they experience any manipulations, so the value of any pre-treatment attributes should be the same across the two arms of our experiment. This is what is called “checking for balance.” If pre-treatment attributes aren’t balanced, then we know our attempt to randomly assign people to different groups failed.</p> <p>To test the quality of the randomization, calculate the average number of pageviews for the treated group and for the control group. Do they look similar?</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >1</span><span class=p >,</span> <span class=s2 >"Pageviews"</span><span class=p >]</span><span class=o >.</span><span class=n >mean</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
9315.135135135135
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >0</span><span class=p >,</span> <span class=s2 >"Pageviews"</span><span class=p >]</span><span class=o >.</span><span class=n >mean</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
9339.0
</pre></div></div> </div> </section> <section id=Exercise-6 > <h3 id=Exercise-6 >Exercise 6<a class=headerlink  href="#Exercise-6" title="Permalink to this headline">¶</a></h3> <p>“Similar” is a tricky concept – obviously, we expect <em>some</em> differences across groups since users were <em>randomly</em> divided across treatment arms. The question is whether the differences between groups are larger than we’d expect to emerge given our random assignment process. To evaluate this, let’s use a <code class="docutils literal notranslate"><span class=pre >ttest</span></code> to test the statistical significance of the differences we see.</p> <p>If you’re using R, you can just use the <code class="docutils literal notranslate"><span class=pre >t.test</span></code> function.</p> <p>If you’re using Python, you can use the <code class="docutils literal notranslate"><span class=pre >ttest</span></code> function from scipy, which you can import as <code class="docutils literal notranslate"><span class=pre >from</span> <span class=pre >scipy.stats</span> <span class=pre >import</span> <span class=pre >ttest_ind</span></code>.</p> <p><strong>Note</strong>: Remember that scipy functions don’t accept <code class="docutils literal notranslate"><span class=pre >pandas</span></code> objects, so you have to pass the numpy vectors underlying your data with the <code class="docutils literal notranslate"><span class=pre >.values</span></code> operator (e.g. <code class="docutils literal notranslate"><span class=pre >df.my_column.values</span></code>).</p> <p>Does the difference in <code class="docutils literal notranslate"><span class=pre >pageviews</span></code> look statistically significant?</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >from</span> <span class=nn >scipy.stats</span> <span class=kn >import</span> <span class=n >ttest_ind</span>

<span class=n >ttest_ind</span><span class=p >(</span>
    <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >1</span><span class=p >,</span> <span class=s2 >"Pageviews"</span><span class=p >]</span><span class=o >.</span><span class=n >values</span><span class=p >,</span>
    <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >0</span><span class=p >,</span> <span class=s2 >"Pageviews"</span><span class=p >]</span><span class=o >.</span><span class=n >values</span><span class=p >,</span>
<span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Ttest_indResult(statistic=-0.1417118298287496, pvalue=0.8877034068650902)
</pre></div></div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># p-value of 0.8877 -- nope! Not statistically different at all.</span>
</pre></div> </div> </div> </section> <section id=Exercise-7 > <h3 id=Exercise-7 >Exercise 7<a class=headerlink  href="#Exercise-7" title="Permalink to this headline">¶</a></h3> <p><code class="docutils literal notranslate"><span class=pre >Pageviews</span></code> is not the only pre-treatment variable in this data. What other measure is pre-treatment? Review the description of the experiment if you’re not sure.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Clicks. The experiment only changes what happens AFTER people click on "free trial", so clicks are "pre-treatment",</span>
</pre></div> </div> </div> </section> <section id=Exercise-8 > <h3 id=Exercise-8 >Exercise 8<a class=headerlink  href="#Exercise-8" title="Permalink to this headline">¶</a></h3> <p>Check if the other pre-treatment variable is also balanced.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >ttest_ind</span><span class=p >(</span>
    <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >1</span><span class=p >,</span> <span class=s2 >"Clicks"</span><span class=p >]</span><span class=o >.</span><span class=n >values</span><span class=p >,</span>
    <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >0</span><span class=p >,</span> <span class=s2 >"Clicks"</span><span class=p >]</span><span class=o >.</span><span class=n >values</span><span class=p >,</span>
<span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Ttest_indResult(statistic=-0.09270642968639531, pvalue=0.9263942642482703)
</pre></div></div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Yup, good balance! Difference has a p-value of only 0.93!</span>
</pre></div> </div> </div> </section> </section> <section id=Estimating-the-Effect-of-Experiment > <h2 id=Estimating-the-Effect-of-Experiment >Estimating the Effect of Experiment<a class=headerlink  href="#Estimating-the-Effect-of-Experiment" title="Permalink to this headline">¶</a></h2> <section id=Exercise-9 > <h3 id=Exercise-9 >Exercise 9<a class=headerlink  href="#Exercise-9" title="Permalink to this headline">¶</a></h3> <p>Now that we’ve established we have good balance (meaning we think randomization was likely successful), we can evaluate the effects of the experiment. Test whether the two metrics you picked have different average values in the control group and treatment group. Because we’ve randomized, this is a consistent estimate of the Average Treatment Effect of Udacity’s website change.</p> <p>Did Udacity achieve their goal?</p> <p><strong>Note:</strong> You may discover some issues with your data. Can you figure out what’s going on, and adjust?</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[15]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Because trials last 2 weeks, you don't get payment</span>
<span class=c1 ># stats from the last two weeks of data.</span>
<span class=c1 ># So we drop them.</span>

<span class=n >users</span> <span class=o >=</span> <span class=n >users</span><span class=p >[</span><span class=n >pd</span><span class=o >.</span><span class=n >notnull</span><span class=p >(</span><span class=n >users</span><span class=o >.</span><span class=n >Enrollments</span><span class=p >)]</span>
</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=p >[</span><span class=s2 >"enroll_but_nopayment_per_click"</span><span class=p >,</span> <span class=s2 >"payments_per_click"</span><span class=p >]:</span>
    <span class=n >wo_change</span> <span class=o >=</span> <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >0</span><span class=p >,</span> <span class=n >i</span><span class=p >]</span><span class=o >.</span><span class=n >mean</span><span class=p >()</span>
    <span class=n >w_change</span> <span class=o >=</span> <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >1</span><span class=p >,</span> <span class=n >i</span><span class=p >]</span><span class=o >.</span><span class=n >mean</span><span class=p >()</span>
    <span class=n >pvalue</span> <span class=o >=</span> <span class=n >ttest_ind</span><span class=p >(</span>
        <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >1</span><span class=p >,</span> <span class=n >i</span><span class=p >]</span><span class=o >.</span><span class=n >values</span><span class=p >,</span>
        <span class=n >users</span><span class=o >.</span><span class=n >loc</span><span class=p >[</span><span class=n >users</span><span class=p >[</span><span class=s2 >"treatment"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >0</span><span class=p >,</span> <span class=n >i</span><span class=p >]</span><span class=o >.</span><span class=n >values</span><span class=p >,</span>
    <span class=p >)</span><span class=o >.</span><span class=n >pvalue</span>

    <span class=nb >print</span><span class=p >(</span>
        <span class=sa >f</span><span class=s2 >"change from orig to experiment in </span><span class=si >{</span><span class=n >i</span><span class=si >}</span><span class=s2 > is "</span>
        <span class=sa >f</span><span class=s2 >" </span><span class=si >{</span><span class=p >(</span><span class=n >w_change</span> <span class=o >-</span> <span class=n >wo_change</span><span class=p >)</span><span class=o >*</span><span class=mi >100</span><span class=si >:</span><span class=s2 >.1f</span><span class=si >}</span><span class=s2 > percentage points"</span>
    <span class=p >)</span>
    <span class=nb >print</span><span class=p >(</span><span class=sa >f</span><span class=s2 >"a change of </span><span class=si >{</span><span class=p >((</span><span class=n >w_change</span> <span class=o >-</span> <span class=n >wo_change</span><span class=p >)</span> <span class=o >/</span> <span class=n >wo_change</span><span class=p >)</span><span class=o >*</span><span class=mi >100</span><span class=si >:</span><span class=s2 >.2f</span><span class=si >}</span><span class=s2 >%"</span><span class=p >)</span>
    <span class=nb >print</span><span class=p >(</span><span class=sa >f</span><span class=s2 >"p-value of difference is </span><span class=si >{</span><span class=n >pvalue</span><span class=si >:</span><span class=s2 >.3f</span><span class=si >}</span><span class=s2 >"</span><span class=p >)</span>
    <span class=nb >print</span><span class=p >(</span><span class=s2 >"</span><span class=se >\n</span><span class=s2 >"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
change from orig to experiment in enroll_but_nopayment_per_click is  -1.6 percentage points
a change of -15.56%
p-value of difference is 0.132


change from orig to experiment in payments_per_click is  -0.5 percentage points
a change of -4.14%
p-value of difference is 0.593


</pre></div></div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[17]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># So we do see a decrease in share of people who click trial,</span>
<span class=c1 ># enroll but then don't pay, and it's borderline significant</span>
<span class=c1 ># (has p-value &lt; 0.1 if we had used a 1-tailed tests).</span>
<span class=c1 ># But we don't see a significant decline in share of people who</span>
<span class=c1 ># click who end up enrolling after trial,</span>
<span class=c1 ># so the change was basically successful in only filtering out</span>
<span class=c1 ># people who weren't really interested.</span>
</pre></div> </div> </div> </section> <section id=Exercise-10 > <h3 id=Exercise-10 >Exercise 10<a class=headerlink  href="#Exercise-10" title="Permalink to this headline">¶</a></h3> <p>One of the magic things about experiments is that all you have to do is compare averages to get an average treatment effect. However, you <em>can</em> do other things to try and increase the statistical power of your experiments, like add controls in a linear regression model.</p> <p>As you likely know, a bivariate regression is exactly equivalent to a t-test, so let’s start by re-estimating the effect of treatment on payments-per-click using a linear regression. Can you replicate the results from your t-test? They shouldn’t just be close – they should be numerically equivalent (i.e. exactly the same to the limits of floating point number precision).</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[18]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >import</span> <span class=nn >statsmodels.formula.api</span> <span class=k >as</span> <span class=nn >smf</span>

<span class=n >smf</span><span class=o >.</span><span class=n >ols</span><span class=p >(</span><span class=s2 >"payments_per_click ~ treatment"</span><span class=p >,</span> <span class=n >users</span><span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span><span class=o >.</span><span class=n >summary</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[18]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <table> <caption>OLS Regression Results</caption> <tr> <th>Dep. Variable: <td>payments_per_click <th> R-squared: <td> 0.007 <tr> <th>Model: <td>OLS <th> Adj. R-squared: <td> -0.016 <tr> <th>Method: <td>Least Squares <th> F-statistic: <td> 0.2903 <tr> <th>Date: <td>Wed, 03 Feb 2021 <th> Prob (F-statistic): <td> 0.593 <tr> <th>Time: <td>14:27:31 <th> Log-Likelihood: <td> 95.810 <tr> <th>No. Observations: <td> 46 <th> AIC: <td> -187.6 <tr> <th>Df Residuals: <td> 44 <th> BIC: <td> -184.0 <tr> <th>Df Model: <td> 1 <th> <td> <tr> <th>Covariance Type: <td>nonrobust <th> <td> </table> <table> <tr> <td> <th>coef <th>std err <th>t <th>P&gt;|t| <th>[0.025 <th>0.975] <tr> <th>Intercept <td> 0.1183 <td> 0.006 <td> 18.403 <td> 0.000 <td> 0.105 <td> 0.131 <tr> <th>treatment <td> -0.0049 <td> 0.009 <td> -0.539 <td> 0.593 <td> -0.023 <td> 0.013 </table> <table> <tr> <th>Omnibus: <td> 0.968 <th> Durbin-Watson: <td> 1.092 <tr> <th>Prob(Omnibus): <td> 0.616 <th> Jarque-Bera (JB): <td> 0.985 <tr> <th>Skew: <td> 0.316 <th> Prob(JB): <td> 0.611 <tr> <th>Kurtosis: <td> 2.662 <th> Cond. No. <td> 2.62 </table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div> </div> </section> <section id=Exercise-11 > <h3 id=Exercise-11 >Exercise 11<a class=headerlink  href="#Exercise-11" title="Permalink to this headline">¶</a></h3> <p>Now add indicator variables for the day of each observation. Do the standard errors on your <code class="docutils literal notranslate"><span class=pre >treatment</span></code> variable change? If so, in what direction?</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[19]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >import</span> <span class=nn >statsmodels.formula.api</span> <span class=k >as</span> <span class=nn >smf</span>

<span class=n >smf</span><span class=o >.</span><span class=n >ols</span><span class=p >(</span><span class=s2 >"payments_per_click ~ treatment + C(Date)"</span><span class=p >,</span> <span class=n >users</span><span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span><span class=o >.</span><span class=n >summary</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[19]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <table> <caption>OLS Regression Results</caption> <tr> <th>Dep. Variable: <td>payments_per_click <th> R-squared: <td> 0.743 <tr> <th>Model: <td>OLS <th> Adj. R-squared: <td> 0.475 <tr> <th>Method: <td>Least Squares <th> F-statistic: <td> 2.770 <tr> <th>Date: <td>Wed, 03 Feb 2021 <th> Prob (F-statistic): <td>0.00991 <tr> <th>Time: <td>14:27:31 <th> Log-Likelihood: <td> 126.94 <tr> <th>No. Observations: <td> 46 <th> AIC: <td> -205.9 <tr> <th>Df Residuals: <td> 22 <th> BIC: <td> -162.0 <tr> <th>Df Model: <td> 23 <th> <td> <tr> <th>Covariance Type: <td>nonrobust <th> <td> </table> <table> <tr> <td> <th>coef <th>std err <th>t <th>P&gt;|t| <th>[0.025 <th>0.975] <tr> <th>Intercept <td> 0.0815 <td> 0.016 <td> 5.090 <td> 0.000 <td> 0.048 <td> 0.115 <tr> <th>C(Date)[T.Fri, Oct 24] <td> 0.0791 <td> 0.022 <td> 3.569 <td> 0.002 <td> 0.033 <td> 0.125 <tr> <th>C(Date)[T.Fri, Oct 31] <td> 0.0777 <td> 0.022 <td> 3.507 <td> 0.002 <td> 0.032 <td> 0.124 <tr> <th>C(Date)[T.Mon, Oct 13] <td> 0.0179 <td> 0.022 <td> 0.809 <td> 0.427 <td> -0.028 <td> 0.064 <tr> <th>C(Date)[T.Mon, Oct 20] <td> 0.0343 <td> 0.022 <td> 1.548 <td> 0.136 <td> -0.012 <td> 0.080 <tr> <th>C(Date)[T.Mon, Oct 27] <td> 0.0799 <td> 0.022 <td> 3.604 <td> 0.002 <td> 0.034 <td> 0.126 <tr> <th>C(Date)[T.Sat, Nov 1] <td> 0.0612 <td> 0.022 <td> 2.763 <td> 0.011 <td> 0.015 <td> 0.107 <tr> <th>C(Date)[T.Sat, Oct 11] <td> -0.0033 <td> 0.022 <td> -0.148 <td> 0.884 <td> -0.049 <td> 0.043 <tr> <th>C(Date)[T.Sat, Oct 18] <td> 0.0239 <td> 0.022 <td> 1.080 <td> 0.292 <td> -0.022 <td> 0.070 <tr> <th>C(Date)[T.Sat, Oct 25] <td> 0.0742 <td> 0.022 <td> 3.347 <td> 0.003 <td> 0.028 <td> 0.120 <tr> <th>C(Date)[T.Sun, Nov 2] <td> 0.0405 <td> 0.022 <td> 1.826 <td> 0.081 <td> -0.005 <td> 0.086 <tr> <th>C(Date)[T.Sun, Oct 12] <td> 0.0239 <td> 0.022 <td> 1.078 <td> 0.293 <td> -0.022 <td> 0.070 <tr> <th>C(Date)[T.Sun, Oct 19] <td> 0.0196 <td> 0.022 <td> 0.887 <td> 0.385 <td> -0.026 <td> 0.066 <tr> <th>C(Date)[T.Sun, Oct 26] <td> 0.0673 <td> 0.022 <td> 3.038 <td> 0.006 <td> 0.021 <td> 0.113 <tr> <th>C(Date)[T.Thu, Oct 16] <td> 0.0095 <td> 0.022 <td> 0.430 <td> 0.672 <td> -0.036 <td> 0.055 <tr> <th>C(Date)[T.Thu, Oct 23] <td> 0.0161 <td> 0.022 <td> 0.725 <td> 0.476 <td> -0.030 <td> 0.062 <tr> <th>C(Date)[T.Thu, Oct 30] <td> 0.0181 <td> 0.022 <td> 0.817 <td> 0.423 <td> -0.028 <td> 0.064 <tr> <th>C(Date)[T.Tue, Oct 14] <td> 0.0394 <td> 0.022 <td> 1.779 <td> 0.089 <td> -0.007 <td> 0.085 <tr> <th>C(Date)[T.Tue, Oct 21] <td> 0.0226 <td> 0.022 <td> 1.022 <td> 0.318 <td> -0.023 <td> 0.069 <tr> <th>C(Date)[T.Tue, Oct 28] <td> 0.0643 <td> 0.022 <td> 2.904 <td> 0.008 <td> 0.018 <td> 0.110 <tr> <th>C(Date)[T.Wed, Oct 15] <td> 0.0157 <td> 0.022 <td> 0.709 <td> 0.486 <td> -0.030 <td> 0.062 <tr> <th>C(Date)[T.Wed, Oct 22] <td> 0.0196 <td> 0.022 <td> 0.884 <td> 0.386 <td> -0.026 <td> 0.066 <tr> <th>C(Date)[T.Wed, Oct 29] <td> 0.0452 <td> 0.022 <td> 2.040 <td> 0.054 <td> -0.001 <td> 0.091 <tr> <th>treatment <td> -0.0049 <td> 0.007 <td> -0.750 <td> 0.461 <td> -0.018 <td> 0.009 </table> <table> <tr> <th>Omnibus: <td> 4.114 <th> Durbin-Watson: <td> 1.713 <tr> <th>Prob(Omnibus): <td> 0.128 <th> Jarque-Bera (JB): <td> 1.796 <tr> <th>Skew: <td> 0.000 <th> Prob(JB): <td> 0.407 <tr> <th>Kurtosis: <td> 2.032 <th> Cond. No. <td> 27.3 </table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div> </div> <p>You should have found that your standard errors decreased by about 20% – this is why, although just comparing means <em>works</em>, if you have additional variables you should add them as covariates in your analysis. Moreover, in other settings you may find this effect is even larger – the date indicators we added to our data are perfectly balanced between treatment and control, so we aren’t adding a lot of data to the model by adding them as variables. As we’ll see in later exercises, adding variables like “gender” or “age” (which will never be perfectly balanced across treatment and control) will help even more.</p> </section> <section id=Exercise-12 > <h3 id=Exercise-12 >Exercise 12<a class=headerlink  href="#Exercise-12" title="Permalink to this headline">¶</a></h3> <p>Given your results, what would you tell Udacity about their trial?</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[20]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># It seems like everything is going in the expected direction. However</span>
<span class=c1 ># before rolling out something that affects something as important</span>
<span class=c1 ># as on-boarding, I would run a longer trial to get a little greater</span>
<span class=c1 ># statistical significance...</span>
</pre></div> </div> </div> </section> <section id=Exercise-13 > <h3 id=Exercise-13 >Exercise 13<a class=headerlink  href="#Exercise-13" title="Permalink to this headline">¶</a></h3> <p>As a last exercise, instead of adding indicators for each date, add indicators for <em>day of the week</em> (e.g. Monday, Tuesday, etc.).</p> <p>(This is just for data manipulation practice!)</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[21]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >users</span><span class=p >[</span><span class=s2 >"day_of_week"</span><span class=p >]</span> <span class=o >=</span> <span class=n >users</span><span class=o >.</span><span class=n >Date</span><span class=o >.</span><span class=n >str</span><span class=o >.</span><span class=n >split</span><span class=p >(</span><span class=s2 >","</span><span class=p >,</span> <span class=n >expand</span><span class=o >=</span><span class=kc >True</span><span class=p >)[</span><span class=mi >0</span><span class=p >]</span>
</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[22]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >smf</span><span class=o >.</span><span class=n >ols</span><span class=p >(</span><span class=s2 >"payments_per_click ~ treatment + C(day_of_week)"</span><span class=p >,</span> <span class=n >users</span><span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span><span class=o >.</span><span class=n >summary</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[22]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <table> <caption>OLS Regression Results</caption> <tr> <th>Dep. Variable: <td>payments_per_click <th> R-squared: <td> 0.138 <tr> <th>Model: <td>OLS <th> Adj. R-squared: <td> -0.021 <tr> <th>Method: <td>Least Squares <th> F-statistic: <td> 0.8687 <tr> <th>Date: <td>Wed, 03 Feb 2021 <th> Prob (F-statistic): <td> 0.540 <tr> <th>Time: <td>14:27:31 <th> Log-Likelihood: <td> 99.073 <tr> <th>No. Observations: <td> 46 <th> AIC: <td> -182.1 <tr> <th>Df Residuals: <td> 38 <th> BIC: <td> -167.5 <tr> <th>Df Model: <td> 7 <th> <td> <tr> <th>Covariance Type: <td>nonrobust <th> <td> </table> <table> <tr> <td> <th>coef <th>std err <th>t <th>P&gt;|t| <th>[0.025 <th>0.975] <tr> <th>Intercept <td> 0.1337 <td> 0.013 <td> 9.971 <td> 0.000 <td> 0.107 <td> 0.161 <tr> <th>C(day_of_week)[T.Mon] <td> -0.0082 <td> 0.018 <td> -0.461 <td> 0.647 <td> -0.044 <td> 0.028 <tr> <th>C(day_of_week)[T.Sat] <td> -0.0133 <td> 0.017 <td> -0.794 <td> 0.432 <td> -0.047 <td> 0.021 <tr> <th>C(day_of_week)[T.Sun] <td> -0.0144 <td> 0.017 <td> -0.865 <td> 0.393 <td> -0.048 <td> 0.019 <tr> <th>C(day_of_week)[T.Thu] <td> -0.0377 <td> 0.018 <td> -2.113 <td> 0.041 <td> -0.074 <td> -0.002 <tr> <th>C(day_of_week)[T.Tue] <td> -0.0101 <td> 0.018 <td> -0.568 <td> 0.574 <td> -0.046 <td> 0.026 <tr> <th>C(day_of_week)[T.Wed] <td> -0.0254 <td> 0.018 <td> -1.425 <td> 0.162 <td> -0.062 <td> 0.011 <tr> <th>treatment <td> -0.0049 <td> 0.009 <td> -0.538 <td> 0.594 <td> -0.023 <td> 0.014 </table> <table> <tr> <th>Omnibus: <td> 0.703 <th> Durbin-Watson: <td> 0.986 <tr> <th>Prob(Omnibus): <td> 0.704 <th> Jarque-Bera (JB): <td> 0.237 <tr> <th>Skew: <td>-0.155 <th> Prob(JB): <td> 0.888 <tr> <th>Kurtosis: <td> 3.168 <th> Cond. No. <td> 9.27 </table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div> </div> </section> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2022, Nick Eubank. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.1.2. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>